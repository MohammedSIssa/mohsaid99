const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MarkdownContent-CGqMU-I6.js","assets/index-CjwPAjfp.js","assets/index-3vNg_j3m.css"])))=>i.map(i=>d[i]);
import{j as e,r as o,_ as M,u as C,a as P,A as k,E as I,D as A,S as B,b as z,c as R,d as O,C as _}from"./index-CjwPAjfp.js";function V({title:t}){return e.jsx("h1",{className:"mb-3 text-3xl font-bold md:mb-5 md:text-4xl",children:t})}function F(t){const s=t.endsWith("Z")?t:t+"Z",r=new Date(s),c=Math.floor((new Date().getTime()-r.getTime())/1e3);if(c<60)return`قبل ${c} ثانية`;const f=Math.floor(c/60);if(f<60)return`قبل ${f} دقيقة`;const l=Math.floor(f/60);return l<24?`قبل ${l} ساعة`:r.toLocaleString("ar-SA",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function Y({time:t}){return e.jsx("p",{className:"border-2 h-full border-(--border-color)/50 bg-(--darker-bg-color) p-2 px-5 rounded-full",children:F(t)})}function G({src:t,alt:s="",className:r=""}){const i=o.useRef(null),[c,f]=o.useState(!1);return o.useEffect(()=>{const l=i.current;if(!l)return;const u=new IntersectionObserver(([b])=>{b.isIntersecting&&(l.src=t,u.disconnect())},{rootMargin:"100px"});return u.observe(l),()=>u.disconnect()},[t]),e.jsx("img",{ref:i,alt:s,onLoad:()=>f(!0),className:`${r} max-h-full rounded-xl object-contain transition-opacity duration-300 ${c?"opacity-100":"opacity-0"}`})}const H="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='200px'%20height='200px'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='%23fff'%20fill-rule='evenodd'%20d='M18.97%206.97a.75.75%200%200%201%201.06%200l-.53.53l.53-.53h.001l.001.002l.003.002l.007.007l.02.02l.062.069c.05.057.12.138.201.241A6.87%206.87%200%200%201%2021.75%2011.5a6.87%206.87%200%200%201-1.425%204.189a5%205%200%200%201-.264.31l-.02.02l-.006.007l-.003.002v.001h-.001l-.51-.508l.51.51a.75.75%200%201%201-1.061-1.061l.53.53l-.53-.53h-.001v.001l-.002.001l.005-.005l.033-.036q.048-.052.139-.167a5.37%205.37%200%200%200%20.448-5.843a5%205%200%200%200-.448-.685a3%203%200%200%200-.172-.203l-.005-.005a.75.75%200%200%201%20.003-1.058m-5.933-3.574c1.163-.767%202.713.068%202.713%201.461v14.286c0%201.394-1.55%202.228-2.713%201.461l-6-3.955a.25.25%200%200%200-.137-.042H4a2.75%202.75%200%200%201-2.75-2.75v-3.714A2.75%202.75%200%200%201%204%207.393h2.9a.25.25%200%200%200%20.138-.041z'%20clip-rule='evenodd'/%3e%3c/svg%3e",J="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='200px'%20height='200px'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='%23fff'%20fill-rule='evenodd'%20d='M17.47%209.47a.75.75%200%200%201%201.06%200L20%2010.94l1.47-1.47a.75.75%200%200%201%201.06%201.06L21.061%2012l1.47%201.47a.75.75%200%200%201-1.061%201.06L20%2013.06l-1.47%201.47a.75.75%200%200%201-1.06-1.06L18.94%2012l-1.47-1.47a.75.75%200%200%201%200-1.06m-4.433-6.074c1.163-.767%202.713.068%202.713%201.461v14.286c0%201.394-1.55%202.228-2.713%201.461l-6-3.955a.25.25%200%200%200-.137-.042H4a2.75%202.75%200%200%201-2.75-2.75v-3.714A2.75%202.75%200%200%201%204%207.393h2.9a.25.25%200%200%200%20.138-.041z'%20clip-rule='evenodd'/%3e%3c/svg%3e";function W({type:t,videoId:s}){const r=o.useRef(null),i=o.useRef(null),[c,f]=o.useState(!1),[l,u]=o.useState(null),[b,d]=o.useState(!0);o.useEffect(()=>{const n=new IntersectionObserver(([p])=>{p.isIntersecting&&(f(!0),n.disconnect())});return r.current&&n.observe(r.current),()=>n.disconnect()},[]),o.useEffect(()=>{if(c)if(window.YT){if(i.current){const n=new window.YT.Player(i.current,{events:{onReady:()=>{u(n),n.mute()}}})}}else{const n=document.createElement("script");n.src="https://www.youtube.com/iframe_api",document.body.appendChild(n),window.onYouTubeIframeAPIReady=()=>{if(i.current){const p=new window.YT.Player(i.current,{events:{onReady:()=>{u(p),p.mute()}}})}}}},[c]),o.useEffect(()=>{if(!l||!r.current)return;const n=new IntersectionObserver(([p])=>{p.isIntersecting&&p.intersectionRatio===1?l.playVideo():l.pauseVideo()},{threshold:[1]});return n.observe(r.current),()=>n.disconnect()},[l]);const x=()=>{if(!l)return;l.getPlayerState()===1?l.pauseVideo():l.playVideo()},h=n=>{n.stopPropagation(),l&&(l.isMuted()?(l.unMute(),d(!1)):(l.mute(),d(!0)))};if(!s)return null;const v=`https://www.youtube.com/embed/${s}?enablejsapi=1&autoplay=1&controls=0&loop=1&playlist=${s}&mute=1&rel=0&modestbranding=1`;return e.jsx("div",{ref:r,className:`${t} relative rounded-2xl`,onClick:x,children:c&&e.jsxs(e.Fragment,{children:[e.jsx("iframe",{ref:i,className:"h-full w-full rounded-2xl",src:v,title:"YouTube video player",allow:"autoplay; encrypted-media",allowFullScreen:!0}),e.jsx("button",{onClick:h,className:"absolute bottom-2 left-2 z-10 rounded-full bg-black/50 p-2 text-white",children:b?e.jsx("img",{src:J,width:25}):e.jsx("img",{src:H,width:25})})]})})}function U({images:t}){const s=t[0].startsWith("video:"),r=s?t[0].split(":")[2]:null,i=s?t[0].split(":")[1]:null;return e.jsxs("div",{className:"slider w-full md:w-fit flex max-h-full min-h-[200px] md:min-w-[200px] max-w-full items-start justify-start gap-2 overflow-x-auto overflow-y-hidden rounded-2xl border-2 border-(--border-color) bg-(--darker-bg-color) p-4",children:[!s&&t.map((c,f)=>e.jsx(G,{src:c},f)),s&&e.jsx(W,{type:i,videoId:r})]})}const L=o.lazy(()=>M(()=>import("./MarkdownContent-CGqMU-I6.js"),__vite__mapDeps([0,1,2])));function Z({body:t,dir:s,showAllText:r=!1}){const[i,c]=o.useState(t?.length<60);return e.jsxs(e.Fragment,{children:[(i||r)&&e.jsx("div",{className:`not-prose block w-full py-2 ${s}`,children:e.jsx(L,{dir:s,content:t})}),i||e.jsx("div",{className:"py-2",children:!r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"not-prose w-full",children:e.jsx(L,{content:t.slice(0,60),dir:s})}),e.jsx("button",{className:"text-(--font-color)/40 hover:cursor-pointer",onClick:()=>c(!0),children:"عرض المزيد"})]})})]})}function q({goal:t}){const s=t.startsWith("✅");return e.jsx("h1",{className:`${s?"border-green-400/30 bg-green-700/70 text-green-100":"border-(--border-color)/70 bg-(--darker-bg-color)/30"} rounded-lg border-2 p-2 px-3`,children:t})}function K({goals:t}){return e.jsx("div",{className:"flex flex-col gap-2",children:t.map((s,r)=>e.jsx(q,{goal:s},r))})}const Q="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='256'%20height='256'%20viewBox='0%200%20256%20256'%3e%3cpath%20fill='%23facc15'%20d='M208%20144a15.78%2015.78%200%200%201-10.42%2014.94L146%20178l-19%2051.62a15.92%2015.92%200%200%201-29.88%200L78%20178l-51.62-19a15.92%2015.92%200%200%201%200-29.88L78%20110l19-51.62a15.92%2015.92%200%200%201%2029.88%200L146%20110l51.62%2019A15.78%2015.78%200%200%201%20208%20144m-56-96h16v16a8%208%200%200%200%2016%200V48h16a8%208%200%200%200%200-16h-16V16a8%208%200%200%200-16%200v16h-16a8%208%200%200%200%200%2016m88%2032h-8v-8a8%208%200%200%200-16%200v8h-8a8%208%200%200%200%200%2016h8v8a8%208%200%200%200%2016%200v-8h8a8%208%200%200%200%200-16'/%3e%3c/svg%3e",D="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='32'%20height='32'%20viewBox='0%200%2032%2032'%3e%3cpath%20fill='%23c1caf5'%20d='M16%202C8.2%202%202%208.2%202%2016s6.2%2014%2014%2014s14-6.2%2014-14S23.8%202%2016%202m5.4%2021L16%2017.6L10.6%2023L9%2021.4l5.4-5.4L9%2010.6L10.6%209l5.4%205.4L21.4%209l1.6%201.6l-5.4%205.4l5.4%205.4z'/%3e%3c/svg%3e";function X({id:t,storyid:s,post:r,handleEditPost:i,setShowEditPost:c}){const[f,l]=o.useState(r?.title??""),[u,b]=o.useState(r?.body??""),[d,x]=o.useState(r?.images??null),[h,v]=o.useState(r?.special??!1),[n,p]=o.useState(r?.secret??!1),[a,m]=o.useState(r?.dir??"rtl"),[g,y]=o.useState(!1),{token:N}=C(),{type:w}=P();async function S(j){j.preventDefault();const $={id:t,title:f,body:u,images:d,storyid:s,type:w??"week",special:h,secret:n,dir:a};try{y(!0),(await fetch(`${k}/posts/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer ${N}`},body:JSON.stringify({...$})})).ok?(l(""),b(""),i($),c(!1)):alert("Failed to edit post.")}catch(T){console.error(T),alert("Server error.")}finally{y(!1)}}return e.jsxs("div",{className:"flex edit-post flex-col overflow-y-auto z-900 md:flex-row md:justify-center pt-10 bg-(--darker-bg-color) gap-5 fixed top-0 left-0 h-dvh w-full",children:[e.jsxs("form",{onSubmit:S,className:"flex relative min-w-[300px] overflow-y-auto pt-15 border border-(--border-color) h-fit bg-(--bg-color) flex-col gap-4 p-5",children:[e.jsx("button",{className:"absolute top-4 right-4 cursor-pointer hover:brightness-110 transition",onClick:()=>c(!1),children:e.jsx("img",{src:D,width:25,height:25})}),e.jsx("input",{type:"text",value:f,onChange:j=>l(j.target.value),placeholder:"العنوان",className:"p-2 rounded border border-(--border-color)",disabled:g}),e.jsxs("select",{value:a,className:"p-2 rounded border border-(--border-color)",onChange:j=>m(j.target.value),children:[e.jsx("option",{className:"bg-(--darker-bg-color)",value:"rtl",children:"Arabic"}),e.jsx("option",{className:"bg-(--darker-bg-color)",value:"ltr",children:"English"})]}),e.jsx("textarea",{dir:a,value:u,onChange:j=>b(j.target.value),placeholder:"المحتوى",className:"p-2 rounded border border-(--border-color)",rows:5,disabled:g}),e.jsx("textarea",{dir:"ltr",value:d&&d.length>0?d.join(", "):"",onChange:j=>x(j.target.value.split(", ").map($=>$)),placeholder:"Images (comma separated)",className:"p-2 rounded border border-(--border-color)",rows:5,disabled:g}),e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>v(!h),children:[e.jsx("div",{className:`w-10 h-5 rounded-full transition-colors duration-300 ${h?"bg-(--accent-color)":"bg-gray-400/50"} relative`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 absolute top-0.5 ${h?"left-5":"left-0.5"}`})}),e.jsx("span",{className:"font-semibold text-sm",children:h?"Special":"Normal"})]}),e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>p(!n),children:[e.jsx("div",{className:`w-10 h-5 rounded-full transition-colors duration-300 ${n?"bg-(--accent-color)":"bg-gray-400/50"} relative`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 absolute top-0.5 ${n?"left-5":"left-0.5"}`})}),e.jsx("span",{className:"font-semibold text-sm",children:n?"Secret":"Normal"})]}),e.jsx("button",{type:"submit",className:`bg-(--accent-color) font-bold p-2 rounded hover:brightness-95 text-black cursor-pointer transition ${g?"opacity-50 cursor-not-allowed":""}`,disabled:g,children:g?"جار الحفظ..":"حفظ"})]}),e.jsx(E,{title:f,body:u,dir:a,storyid:s,images:d||[],type:w||"",special:h,secret:n,isEditting:!0,handleDeletePost:()=>{}})]})}function E({title:t,id:s,time:r,images:i,body:c,dir:f,type:l,special:u,secret:b,storyid:d,isEditting:x=!1,isCreating:h=!1,handleEditPost:v,handleDeletePost:n}){const[p,a]=o.useState(!1),{isAdmin:m,token:g}=C();async function y(N){if(!confirm("Delete post?"))return;(await fetch(`${k}/posts/${N}`,{method:"DELETE",headers:{authorization:`Bearer ${g}`,"Content-Type":"application/json"}})).ok&&(n(N),alert("Deleted!"))}return e.jsxs("div",{className:`${u?"text-yellow-200":""} 
       ${b?"text-fuchsia-200":""} 
       flex post relative px-3 flex-col items-start 
       justify-start gap-4 w-full 
       md:max-w-4xl border-b-2 
       border-(--border-color) py-5 pt-10`,children:[m&&!x&&!h&&e.jsxs("div",{className:"absolute left-2 top-8 bg-(--darker-bg-color) rounded-full p-2 px-4 border border-(--border-color)/50 flex gap-2",children:[e.jsx("button",{className:"cursor-pointer p-2 bg-(--accent-color) text-black rounded-full hover:brightness-95 transition",onClick:()=>a(!0),children:e.jsx("img",{src:I,width:20,height:20})}),e.jsx("button",{className:"cursor-pointer p-2 bg-red-300 text-black rounded-full hover:brightness-95 transition",onClick:()=>{y(s??0)},children:e.jsx("img",{src:A,width:20,height:20})})]}),p&&m&&e.jsx(X,{id:s??0,storyid:d,post:{storyid:d,title:t,body:c,images:i,dir:f,type:l,special:u,secret:b},handleEditPost:v||(()=>{}),setShowEditPost:a}),t.trim()!==""&&e.jsx(V,{title:t}),e.jsxs("div",{className:"flex gap-2 items-center justify-center",children:[s&&s>436&&e.jsx(Y,{time:r||""}),u&&e.jsx("span",{className:"bg-yellow-300/10 border-2 border-yellow-300/20 rounded-full p-2",children:e.jsx("img",{src:Q,width:26})}),b&&e.jsx("span",{className:"bg-fuchsia-300/10 border-2 border-fuchsia-300/20 rounded-full p-2",children:e.jsx("img",{src:B,width:26})})]}),l==="goal"?e.jsx(K,{goals:c.split(`
`)}):e.jsx(Z,{body:c,dir:f,showAllText:i?.length===0}),i&&i.length>0&&e.jsx(U,{images:i})]})}function ee({storyid:t,handleCreatePost:s,setShowCreatePost:r}){const[i,c]=o.useState(""),[f,l]=o.useState(""),[u,b]=o.useState(null),[d,x]=o.useState(!1),[h,v]=o.useState(!1),[n,p]=o.useState("rtl"),[a,m]=o.useState(!1),{token:g}=C(),{type:y}=P();async function N(w){w.preventDefault();const S={title:i,body:f,images:u,storyid:t,type:y??"week",special:d,secret:h,dir:n};try{m(!0),(await fetch(`${k}/posts`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${g}`},body:JSON.stringify({...S})})).ok?(c(""),l(""),s(S),r(!1)):alert("Failed to create post.")}catch(j){console.error(j),alert("Server error.")}finally{m(!1)}}return e.jsxs("div",{className:"flex flex-col overflow-y-auto z-999 md:flex-row md:justify-center pt-10 bg-(--darker-bg-color) gap-5 fixed inset-0 w-full",children:[e.jsxs("form",{onSubmit:N,className:"flex relative min-w-[300px] overflow-y-auto pt-15 border border-(--border-color) h-fit bg-(--bg-color) flex-col gap-4 p-5",children:[e.jsx("button",{className:"absolute top-4 right-4 cursor-pointer hover:brightness-110 transition",onClick:()=>r(!1),children:e.jsx("img",{src:D,width:25,height:25})}),e.jsx("input",{type:"text",value:i,onChange:w=>c(w.target.value),placeholder:"العنوان",className:"p-2 rounded border border-(--border-color)",disabled:a}),e.jsxs("select",{value:n,className:"p-2 rounded border border-(--border-color)",onChange:w=>p(w.target.value),children:[e.jsx("option",{className:"bg-(--darker-bg-color)",value:"rtl",children:"عربي"}),e.jsx("option",{className:"bg-(--darker-bg-color)",value:"ltr",children:"انجلش"})]}),e.jsx("textarea",{dir:n,value:f,onChange:w=>l(w.target.value),placeholder:"المحتوى",className:"p-2 rounded border border-(--border-color)",rows:5,disabled:a}),e.jsx("textarea",{dir:"ltr",value:u&&u.length>0?u.join(", "):"",onChange:w=>b(w.target.value.split(", ").map(S=>S)),placeholder:"Images (comma separated)",className:"p-2 rounded border border-(--border-color)",rows:5,disabled:a}),e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>x(!d),children:[e.jsx("div",{className:`w-10 h-5 rounded-full transition-colors duration-300 ${d?"bg-(--accent-color)":"bg-gray-400/50"} relative`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 absolute top-0.5 ${d?"left-5":"left-0.5"}`})}),e.jsx("span",{className:"font-semibold text-sm",children:d?"Special":"Normal"})]}),e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>v(!h),children:[e.jsx("div",{className:`w-10 h-5 rounded-full transition-colors duration-300 ${h?"bg-(--accent-color)":"bg-gray-400/50"} relative`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 absolute top-0.5 ${h?"left-5":"left-0.5"}`})}),e.jsx("span",{className:"font-semibold text-sm",children:h?"Secret":"Normal"})]}),e.jsx("button",{type:"submit",className:`bg-(--accent-color) font-bold p-2 rounded hover:brightness-95 text-black cursor-pointer transition ${a?"opacity-50 cursor-not-allowed":""}`,disabled:a,children:a?"جار الإنشاء..":"أنشئ المنشور"})]}),e.jsx(E,{title:i,body:f,storyid:t,dir:n,images:u||[],type:y||"",special:d,secret:h,isCreating:!0,handleDeletePost:()=>{}})]})}const te=async(t,s)=>{const r=new Date().toLocaleTimeString(),i=new Date().toLocaleDateString(),c=navigator.platform+"";await fetch(`${k}/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitedAt:`${r} - ${i}`,os:c,url:s,username:t})})};function re(){const{type:t,count:s}=z(),{setType:r}=P(),{token:i,isAdmin:c,user:f}=C(),[l,u]=o.useState(!1);function b(a){x(m=>m===null?[a]:[a,...m])}o.useEffect(()=>{if(!c&&t){async function a(){await te(f.username??"guest - ",t&&s?`${t} - ${s}`:"Home")}a()}},[t,s]),o.useEffect(()=>{t&&r(t)},[t,r]);const[d,x]=o.useState(null),[h,v]=o.useState(!0),[n,p]=o.useState("");return o.useEffect(()=>{async function a(){try{v(!0),x(null);const m=await fetch(`${k}/posts?type=${t}&count=${s}`,{method:"GET",headers:{authorization:`Bearer ${i}`}});if(m.ok){const g=await m.json();x(g),v(!1),p("")}else v(!1),p("Something went wrong."),x(null)}catch{x(null),v(!1),p("Server Error")}}a()},[s]),R("/mohsaid99/favicons/"+t+".svg"),h?e.jsx("div",{className:"flex flex-1 h-dvh items-center justify-center",children:e.jsx("div",{className:"animate-spin w-7 h-7",children:e.jsx("img",{src:O,alt:"spinning animation",width:28})})}):n?e.jsxs("div",{className:"flex h-screen items-center justify-center",children:["Error: ",n]}):d&&d.length>0?e.jsxs("div",{className:"flex flex-col md:pr-16 min-h-screen items-center justify-center py-25",children:[c&&e.jsx("button",{className:"bg-(--accent-color) rounded-full flex items-center justify-center w-[60px] h-[60px]",onClick:()=>u(!l),children:l?null:e.jsx("img",{src:_,width:30})}),l&&c&&e.jsx(ee,{setShowCreatePost:u,handleCreatePost:b,storyid:d[0].storyid}),d.map(a=>e.jsx(E,{storyid:a?.storyid??0,id:a?.id??0,title:a.title??"",time:a.iat??"",images:a?.images??[],body:a.body??"",dir:a.dir,type:a.type,special:a.special??!1,secret:a.secret??!1,handleEditPost:m=>x(g=>g&&g.map(y=>y.id===m.id?m:y)),handleDeletePost:m=>x(d.filter(g=>g.id!==m))},a.id))]}):e.jsx("div",{className:"flex h-screen items-center justify-center",children:"No content available."})}export{re as default};
