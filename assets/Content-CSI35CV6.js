import{r as a,j as e,u as S,A as k,a as C,b as $,M as E,c as I,N as L,d as B}from"./index-Cin-C7kg.js";import{S as D}from"./Stories-Bg91w8H9.js";function A({body:t,showAllText:s=!1}){const[r,n]=a.useState(t?.length<60);function i(u){return/[\u0600-\u06FF]/.test(u)?"rtl":"ltr"}const o=i(t);return e.jsxs(e.Fragment,{children:[(r||s)&&e.jsx("div",{className:"flex flex-col gap-2 py-2",children:e.jsx("pre",{dir:o,className:"max-w-full md:max-w-[700px]",children:t})}),r||e.jsx("div",{className:"py-2",children:!s&&e.jsxs("pre",{dir:o,className:"max-w-full md:max-w-[700px]",children:[t?.slice(0,60),"..."," ",e.jsx("button",{className:"text-zinc-500 hover:cursor-pointer hover:text-zinc-300",onClick:()=>n(!0),children:"عرض المزيد"})]})})]})}function z(t){const s=t.endsWith("Z")?t:t+"Z",r=new Date(s),i=Math.floor((new Date().getTime()-r.getTime())/1e3);if(i<60)return`${i}s ago`;const o=Math.floor(i/60);if(o<60)return`${o}m ago`;const u=Math.floor(o/60);return u<24?`${u}h ago`:r.toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function M({time:t}){return e.jsx("p",{className:"text-white/50",children:z(t)})}function O({title:t}){return e.jsx("h1",{className:"mb-3 text-3xl font-bold md:mb-5 md:text-4xl",children:t})}function U({src:t,alt:s="",className:r=""}){const n=a.useRef(null),[i,o]=a.useState(!1);return a.useEffect(()=>{const u=n.current;if(!u)return;const h=new IntersectionObserver(([p])=>{p.isIntersecting&&(u.src=t,h.disconnect())},{rootMargin:"100px"});return h.observe(u),()=>h.disconnect()},[t]),e.jsx("img",{ref:n,alt:s,onLoad:()=>o(!0),className:`${r} max-h-full rounded-xl object-contain transition-opacity duration-300 ${i?"opacity-100":"opacity-0"}`})}function W({type:t,videoId:s}){const r=`https://www.youtube.com/embed/${s}?autoplay=1&controls=0&loop=1&playlist=${s}&mute=1`;return e.jsx("iframe",{className:t+" rounded-2xl",src:r,title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0})}function G({images:t}){const s=t[0].startsWith("video:"),r=s?t[0].split(":")[2]:null,n=s?t[0].split(":")[1]:null;return e.jsxs("div",{className:"flex max-h-full min-h-[200px] w-full max-w-full items-start justify-start gap-2 overflow-x-auto overflow-y-hidden rounded-2xl border-2 border-white/10 bg-white/10 p-4",children:[!s&&t.map((i,o)=>e.jsx(U,{src:i},o)),s&&e.jsx(W,{type:n,videoId:r})]})}function R({goal:t}){const s=t.startsWith("✅");return e.jsx("h1",{className:`${s?"border-green-100/40 bg-green-500/40 text-green-100":"border-white/10 bg-white/10"} rounded-lg border-2 p-2 px-3`,children:t})}function V({goals:t}){return e.jsx("div",{className:"flex flex-col gap-2",children:t.map((s,r)=>e.jsx(R,{goal:s},r))})}function J({post:t}){const[s,r]=a.useState(t.title??""),[n,i]=a.useState(t.body??""),[o,u]=a.useState(t?.images?.join(", ")??""),[h,p]=a.useState(t.images??[]),[g,j]=a.useState(t.special??!1),[w,d]=a.useState(t.secret??!1),[x,N]=a.useState(t.type??""),[y,_]=a.useState(t.storyid??0),[v,m]=a.useState(""),{user:f}=S();async function c(l){l.preventDefault();try{const b=await fetch(k+"/posts/"+x+"/"+y+"/"+t.id,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer: ${f?.apikey}`},body:JSON.stringify({title:s,body:n,images:h,special:g,secret:w,type:x,storyid:y})});b.ok&&m("Updated!"),b.status===500&&m("Server Error!"),b.status>=400&&b.status<500&&m("Unauthorized!")}catch(b){console.error(b),m("Client Error!")}}return e.jsxs("form",{onSubmit:c,className:"flex flex-col gap-1 rounded-xl border-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-white/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-white/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{id:"title",value:s,onChange:l=>r(l.target.value)}),e.jsxs("label",{htmlFor:"storyid",dir:"ltr",children:["Story Count:"," "]}),e.jsx("input",{id:"storyid",type:"number",value:y,onChange:l=>_(+l.target.value)}),e.jsxs("label",{htmlFor:"type",dir:"ltr",children:["Type:"," "]}),e.jsxs("select",{className:"[&_option]:bg-black",value:x,onChange:l=>N(l.target.value),children:[e.jsx("option",{value:"week",children:"Weeks"}),e.jsx("option",{value:"goal",children:"Goals"}),e.jsx("option",{value:"blog",children:"Blogs"}),e.jsx("option",{value:"special",children:"Special"})]}),e.jsxs("label",{htmlFor:"body",dir:"ltr",children:["Body:"," "]}),e.jsx("textarea",{id:"body",value:n,onChange:l=>i(l.target.value)}),e.jsxs("label",{htmlFor:"images",dir:"ltr",children:["Images:"," "]}),e.jsx("textarea",{id:"images",dir:"ltr",value:o,onChange:l=>{const b=l.target.value;u(b);const P=b.split(", ").map(T=>T.trim()).filter(Boolean);p(P)}}),e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-white/10 [&_div]:p-2",children:[e.jsxs("div",{className:`flex items-center justify-center gap-2 ${g===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{id:"special",type:"checkbox",className:"opacity-30",checked:g,onChange:l=>j(l.target.checked)})]}),e.jsxs("div",{className:`flex items-center justify-center gap-2 ${w===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"secret",dir:"ltr",children:"Secret?"}),e.jsx("input",{id:"secret",type:"checkbox",className:"opacity-30",checked:w,onChange:l=>d(l.target.checked)})]})]}),e.jsx("p",{dir:"ltr",children:v}),e.jsx("button",{type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"حفظ التعديلات"})]})}function F({post:t,isPerview:s=!1}){const[r,n]=a.useState(!1),{isAdmin:i,isMonmon:o,user:u}=S(),h=t.secret&&(i()||o());async function p(){try{window.confirm(`Are you sure you want to fetch(${"/posts/"+t.type+"/"+t.storyid+"/"+t.id})`)&&(await fetch("http://localhost:3000/new-mohsaid99/posts/"+t.type+"/"+t.storyid+"/"+t.id,{method:"DELETE",headers:{authorization:`Bearer: ${u?.apikey}`}})).ok&&alert("Deleted post!")}catch{alert("Could not delete post!")}}return e.jsxs("div",{className:`${h?"flex":t.secret?"hidden":"flex"} ${t.special?"border-yellow-300/30 bg-yellow-300/20 text-yellow-200":""} ${t.secret?"text-fuchsia-300":""} post w-full max-w-full flex-col gap-2 border-t-2 border-b-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl md:w-fit md:max-w-[700px] md:min-w-[500px] md:rounded-xl md:border-2 lg:max-w-[900px]`,children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx(O,{title:t?.title??""}),(t?.id??500)>436&&!s&&e.jsx(M,{time:t.iat??""}),t.type!=="goal"&&e.jsx(A,{body:t?.body??"",showAllText:t?.images?.length===0}),t.type==="goal"&&e.jsx(V,{goals:t.body.split(`
`)}),t?.images&&t?.images.length>0&&e.jsx(G,{images:t?.images??[]})]}),r&&e.jsx(J,{post:t}),i()&&!s&&e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx("button",{className:"rounded bg-blue-600 p-2 px-3 text-white",onClick:()=>n(!r),children:r?e.jsx(C,{}):e.jsx($,{})}),e.jsx("button",{className:"rounded bg-red-500 p-2 px-3 text-white",onClick:p,children:e.jsx(E,{})})]})]})}function Y({type:t,storyid:s}){const[r,n]=a.useState(""),[i,o]=a.useState(""),[u,h]=a.useState(""),[p,g]=a.useState([]),[j,w]=a.useState(!1),[d,x]=a.useState(!1),[N,y]=a.useState(!1),[_,v]=a.useState(""),{user:m}=S();async function f(c){c.preventDefault();try{const l=await fetch(k+"/posts/"+t+"/"+s,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer: ${m?.apikey}`},body:JSON.stringify({title:r,body:i,images:p,special:j,secret:d,type:t,storyid:s})});l.ok&&(v("Post added successfully!"),n(""),o(""),x(!1),w(!1),h("")),l.status===500&&v("Server Error!"),l.status>=400&&l.status<500&&v("Unauthorized!")}catch(l){console.error(l),v("Client Error!")}}if(!N)return e.jsx("button",{className:"cursor-pointer rounded-xl border-2 border-white/20 bg-white/10 p-10 px-25 transition-all duration-200 hover:brightness-150",onClick:()=>y(!0),children:e.jsx(I,{size:30})});if(N)return e.jsxs("div",{className:"mb-5 flex flex-col items-center gap-5",children:[e.jsxs("form",{onSubmit:f,className:"flex max-w-fit flex-col gap-1 rounded-xl border-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl md:min-w-[400px] [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-white/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-white/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("h1",{className:"font-bold",dir:"ltr",children:["Add a post for ",t," ",s]}),e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{id:"title",value:r,onChange:c=>n(c.target.value)}),e.jsxs("label",{htmlFor:"body",dir:"ltr",children:["Body:"," "]}),e.jsx("textarea",{id:"body",value:i,onChange:c=>o(c.target.value)}),e.jsxs("label",{htmlFor:"images",dir:"ltr",children:["Images:"," "]}),e.jsx("textarea",{id:"images",dir:"ltr",value:u,onChange:c=>{const l=c.target.value;h(l);const b=l.split(", ").map(P=>P.trim()).filter(Boolean);g(b)}}),e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-white/10 [&_div]:p-2",children:[e.jsxs("div",{className:`flex items-center justify-center gap-2 ${j===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{id:"special",type:"checkbox",className:"opacity-30",checked:j,onChange:c=>w(c.target.checked)})]}),e.jsxs("div",{className:`flex items-center justify-center gap-2 ${d===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"secret",dir:"ltr",children:"Secret?"}),e.jsx("input",{id:"secret",type:"checkbox",className:"opacity-30",checked:d,onChange:c=>x(c.target.checked)})]})]}),e.jsx("p",{dir:"ltr",children:_}),e.jsx("button",{type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"حفظ التعديلات"})]}),e.jsx(F,{post:{title:r,body:i,images:p,special:j,secret:d,type:t,storyid:s},isPerview:!0}),e.jsx("button",{className:"cursor-pointer rounded-xl border-2 border-white/20 bg-white/10 p-10 px-25 transition-all duration-200 hover:brightness-150",onClick:()=>y(!1),children:e.jsx(C,{size:30})})]})}function Z({posts:t,type:s,storyid:r}){const{isAdmin:n}=S();return e.jsxs("div",{className:"flex w-full flex-col items-center pt-20",children:[e.jsxs("div",{className:"mx-auto mb-2 flex gap-2 md:hidden",children:[e.jsx("p",{className:"counter rounded border-2 border-white/20 bg-white/10 p-2 px-5 font-bold",children:r}),e.jsx("p",{className:"counter rounded border-2 border-white/20 bg-white/10 p-2 px-5 font-bold",children:s})]}),e.jsx("div",{className:"mb-5",children:n()&&e.jsx(Y,{type:s,storyid:r})}),!n()&&t.length===0&&e.jsx("h1",{className:"text-2xl font-bold",children:"لا توجد منشورات"}),e.jsx("div",{className:"flex w-full flex-col items-center gap-5",children:t.map((i,o)=>e.jsx(F,{post:i},o))})]})}function q(){const t=Array.from({length:5});return e.jsx("div",{className:"flex w-full flex-col items-center gap-5 pt-30 md:pt-20",children:t.map((s,r)=>e.jsxs("div",{className:"flex w-full max-w-full animate-pulse flex-col gap-2 border-t-2 border-b-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl odd:min-h-[200px] even:min-h-[350px] even:delay-200 md:w-fit md:max-w-[700px] md:rounded-xl md:border-2 md:odd:min-w-[600px] md:even:min-w-[700px] [&_div]:rounded-lg",children:[e.jsx("div",{className:"mb-5 w-[40%] animate-pulse bg-white/10 p-5"}),e.jsx("div",{className:"w-[70%] animate-pulse bg-white/10 p-2"}),e.jsx("div",{className:"w-[50%] animate-pulse bg-white/10 p-2"}),e.jsx("div",{className:"w-[60%] animate-pulse bg-white/10 p-2"}),e.jsx("div",{className:"h-[200px] max-h-[60%] w-full animate-pulse bg-white/10 p-2"})]},r))})}function H(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة الأهداف"}),e.jsx("p",{children:"هنا بكتب أهداف كل ربع بالسنة"}),e.jsx("p",{children:"الهدف هنا التركيز على أهدافي ومحاولة تحقيقها"})]})}function K(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة الأسابيع أو اليوميات"}),e.jsx("p",{children:"هنا بكتب آخر الأحداث اللي بتصير معي"}),e.jsx("p",{children:"الرحلة موثقة هنا من أول يوم بسنة 2025"})]})}function Q(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة المحتوى الخاص"}),e.jsx("p",{children:"الجزء هاد كان هدية الـ11 شهر"}),e.jsx("p",{children:" المحتوى هنا محدش بيقدر يشوفو غير شخص واحد"}),e.jsx("p",{children:"هان بكتب آخر التطورات بشكل شخصي اكتر"})]})}function X({type:t}){return e.jsxs("div",{children:[t==="week"&&e.jsx(K,{}),t==="goal"&&e.jsx(H,{}),t==="special"&&e.jsx(Q,{})]})}function ee(){return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-5",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"هاد الصفحة غير موجودة"}),e.jsx(L,{to:"/",className:"text-violet-200 underline",replace:!0,children:"اضغط هنا"})]})}const te=async(t,s)=>{const r=new Date().toLocaleTimeString(),n=new Date().toLocaleDateString(),i=navigator.platform+"";await fetch(`${k}/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitedAt:`${r} - ${n}`,os:i,url:s,username:t})})};function ae(){const[t,s]=a.useState(null),[r,n]=a.useState(null),[i,o]=a.useState(!0),[u,h]=a.useState(!1),[p,g]=a.useState(!0),[j,w]=a.useState(!1),{type:d,storyid:x}=B(),{isAdmin:N}=S(),{user:y}=S(),_=["week","blog","goal","special"];function v(m){s(f=>f?.filter(c=>c.count!==m)??null)}return a.useEffect(()=>{async function m(){try{const f=await fetch(k+"/stories/"+d);if(f.ok){const c=await f.json();s(c),h(!1)}else h(!0)}catch{h(!0)}finally{o(!1)}}d&&["week","blog","goal","special"].includes(d)&&m()},[d]),a.useEffect(()=>{async function m(){try{g(!0);const f=await fetch(k+"/posts/"+d+"/"+x);if(f.ok){const c=await f.json();n(c),w(!1),N()||await te(y?.username??"guest",`${d} - ${x}`)}}catch{w(!0)}finally{g(!1)}}x!==void 0&&m()},[d,x]),d&&!_.includes(d)?e.jsx(ee,{}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 md:flex-row",children:[i&&e.jsx("h1",{}),u&&e.jsx("h1",{}),!i&&e.jsx(D,{stories:t??[],onDeleteStory:v}),p&&x!==void 0&&e.jsx(q,{}),x===void 0&&e.jsx(X,{type:t!==null&&typeof t[0].type=="string"?t[0].type:void 0}),j&&e.jsx("h1",{}),!p&&x!==void 0&&e.jsx(Z,{posts:r??[],type:d!==void 0?d:"",storyid:x!==void 0?parseInt(x):0})]})}export{ae as default};
