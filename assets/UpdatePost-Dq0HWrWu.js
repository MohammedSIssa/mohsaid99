import{r,u as F,a as w,j as e}from"./index-D8t40jS5.js";import{P as A}from"./Post-C8z17lhz.js";import{A as m}from"./globals-mhpEhTSX.js";import{d as $}from"./cache-UbEKbjRU.js";function E(){const[c,h]=r.useState(""),[d,y]=r.useState(""),[n,f]=r.useState(0),[s,v]=r.useState(""),[l,j]=r.useState("week"),[u,C]=r.useState(!1),[b,k]=r.useState(!1),[N,i]=r.useState(""),[a,p]=r.useState(!0),{user:x}=F(),{id:g}=w(),S=`${m}/posts/${g}`,P=`${m}/${l}/${n}`;r.useEffect(()=>{async function t(){i("Fetching post from database.."),p(!0);const o=await(await fetch(S,{headers:{Authorization:`Bearer ${x.apikey}`}})).json();h(o.title),y(o.body),f(o.storyid),j(o.type),C(o.special),k(o.secret),i("Fetched Post!"),p(!1),v(o.images.join(" "))}t()},[g,S,x.apikey]);async function z(t){t.preventDefault(),i("Updating post.."),p(!0),console.log({title:c,body:d,storyid:n,type:l,images:s.trim()!==""?s.split(" "):[]});const _=`${m}/update/posts/${g}`;if((await fetch(_,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x.apikey}`},body:JSON.stringify({title:c,body:d,storyid:n,type:l,images:s.trim()!==""?s.split(" "):[],special:u,secret:b})})).ok)$(P),i("Post updated successfully!"),p(!1);else throw i("Error happened"),new Error("Unable to update post")}return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-10",children:[e.jsxs("form",{onSubmit:z,className:"flex max-w-[600px] min-w-[300px] flex-col gap-4 rounded-xl border border-zinc-700 bg-zinc-900 p-10",style:{backgroundColor:"var(--story-bg-color)",borderColor:"var(--story-border-color)"},children:[e.jsx("p",{className:"text-xl font-bold text-green-200",children:"فورم تحديث المنشورات"}),e.jsx("hr",{style:{borderColor:"var(--story-border-color)"}}),e.jsx("div",{className:"flex flex-wrap items-center gap-5",dir:"ltr"}),e.jsxs("label",{htmlFor:"post_type",dir:"ltr",children:["Type: ",l]}),e.jsxs("select",{id:"post_type",name:"type",value:l,onChange:t=>j(t.target.value),className:"bg-zinc-800 p-2 text-zinc-50 focus:border focus:border-zinc-600 focus:outline-0",style:{backgroundColor:"var(--bg-color)",borderColor:"var(--story-border-color)"},disabled:a,children:[e.jsx("option",{value:"week",children:"Week"}),e.jsx("option",{value:"goal",children:"Goal"}),e.jsx("option",{value:"blog",children:"Blog"}),e.jsx("option",{value:"special",children:"Special"}),e.jsx("option",{value:"stat",children:"Stats"})]}),e.jsxs("label",{htmlFor:"story_id",dir:"ltr",children:["Story ID:"," "]}),e.jsx("input",{type:"number",id:"story_id",value:n,onChange:t=>f(t.target.value),className:"rounded-lg bg-zinc-800 p-2 px-5 text-zinc-50 focus:outline-0 disabled:opacity-30",disabled:a,style:{backgroundColor:"var(--bg-color)",borderColor:"var(--story-border-color)"}}),e.jsxs("label",{htmlFor:"post_title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{type:"text",name:"title",id:"post_title",value:c,onChange:t=>h(t.target.value),className:"rounded-lg bg-zinc-800 p-2 px-5 text-xl font-bold text-zinc-50 focus:outline-0 disabled:opacity-30",disabled:a,style:{backgroundColor:"var(--bg-color)",borderColor:"var(--story-border-color)"}}),e.jsxs("label",{htmlFor:"post_body",dir:"ltr",children:["Body:"," "]}),e.jsx("textarea",{type:"text",name:"body",id:"post_body",value:d,onChange:t=>y(t.target.value),className:"min-h-fit rounded-lg bg-zinc-800 p-2 px-5 text-zinc-50 focus:outline-0 disabled:opacity-30",disabled:a,style:{backgroundColor:"var(--bg-color)",borderColor:"var(--story-border-color)"}}),e.jsxs("label",{htmlFor:"post_images",dir:"ltr",children:["Images:"," "]}),e.jsx("textarea",{dir:"ltr",name:"images",type:"text",value:s,onChange:t=>v(t.target.value),className:"min-h-fit rounded-lg bg-zinc-800 p-2 px-5 text-zinc-50 focus:outline-0 disabled:opacity-30",disabled:a,style:{backgroundColor:"var(--bg-color)",borderColor:"var(--story-border-color)"},id:"post_images"}),e.jsxs("div",{className:"flex items-center justify-center gap-4",dir:"ltr",children:[e.jsx("label",{htmlFor:"add_story_isSpecial",dir:"ltr",children:"Golden Post?"}),e.jsx("input",{type:"checkbox",id:"add_story_isSpecial",name:"special",checked:u??!1,value:u??!1,onChange:t=>C(t.target.checked)})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4",dir:"ltr",children:[e.jsx("label",{htmlFor:"add_story_isSecret",dir:"ltr",children:"Secret Post?"}),e.jsx("input",{type:"checkbox",id:"add_story_isSecret",name:"special",checked:b??!1,value:b??!1,onChange:t=>k(t.target.checked)})]}),e.jsx("hr",{className:"border-zinc-800"}),e.jsx("button",{onClick:z,disabled:a,className:"rounded-lg border border-zinc-950 bg-zinc-950 p-2 px-5 transition-all duration-100 hover:cursor-pointer hover:border hover:border-zinc-700 hover:bg-zinc-800",style:{backgroundColor:"var(--bg-color)",borderColor:"var(--story-border-color)"},children:"Update"}),e.jsx("p",{dir:"ltr",children:N})]}),e.jsx("p",{className:"text-xl font-bold text-green-200",children:"المنشور بعض التعديلات"}),e.jsx("hr",{className:"border-zinc-800"}),a||e.jsx(A,{title:c,body:d,images:s.trim()!==""?s.split(" "):[],fromAdmin:!0})]})}export{E as default};
