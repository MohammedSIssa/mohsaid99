const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VideoPlayer-Bt22b-CK.js","assets/index-Bw2C-8-k.js","assets/index-DMBSQxps.css","assets/MarkdownContent-CQyDwfPW.js"])))=>i.map(i=>d[i]);
import{j as e,r as i,_ as I,R as B,u as E,a as L,A as k,E as A,D as O,S as z,b as H,c as R,d as V,C as D}from"./index-Bw2C-8-k.js";function F({title:t}){return e.jsx("h1",{className:"mb-3 text-3xl font-bold md:mb-5 md:text-4xl",children:t})}function G(t){const r=t.endsWith("Z")?t:t+"Z",s=new Date(r),d=Math.floor((new Date().getTime()-s.getTime())/1e3);if(d<60)return`Ù‚Ø¨Ù„ ${d} Ø«Ø§Ù†ÙŠØ©`;const c=Math.floor(d/60);if(c===1)return"Ù‚Ø¨Ù„ Ø¯Ù‚ÙŠÙ‚Ø©";if(c===2)return"Ù‚Ø¨Ù„ Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†";if(c>=3&&c<11)return`Ù‚Ø¨Ù„ ${c} Ø¯Ù‚Ø§Ø¦Ù‚`;if(c<60)return`Ù‚Ø¨Ù„ ${c} Ø¯Ù‚ÙŠÙ‚Ø©`;const l=Math.floor(c/60);return l===1?"Ù‚Ø¨Ù„ Ø³Ø§Ø¹Ø©":l===2?"Ù‚Ø¨Ù„ Ø³Ø§Ø¹ØªÙŠÙ†":l>=3&&l<11?`Ù‚Ø¨Ù„ ${l} Ø³Ø§Ø¹Ø§Øª`:l<24?`Ù‚Ø¨Ù„ ${l} Ø³Ø§Ø¹Ø©`:s.toLocaleString("ar-SA",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function J({time:t}){return e.jsx("p",{className:"border-2 h-full border-(--border-color)/50 bg-(--darker-bg-color) p-2 px-5 rounded-full",children:G(t)})}function W({src:t,alt:r="",className:s=""}){const o=i.useRef(null),[d,c]=i.useState(!1);return i.useEffect(()=>{const l=o.current;if(!l)return;const u=new IntersectionObserver(([m])=>{m.isIntersecting&&(l.src=t,u.disconnect())},{rootMargin:"100px"});return u.observe(l),()=>u.disconnect()},[t]),e.jsx("img",{ref:o,alt:r,onLoad:()=>c(!0),className:`${s} max-h-full rounded-xl object-contain transition-opacity duration-300 ${d?"opacity-100":"opacity-0"}`})}const q=i.lazy(()=>I(()=>import("./VideoPlayer-Bt22b-CK.js"),__vite__mapDeps([0,1,2])));function K({images:t}){const r=t[0].startsWith("video:"),s=r?t[0].split(":")[2]:null,o=r?t[0].split(":")[1]:null;return e.jsxs("div",{className:"slider w-full md:w-fit flex max-h-full min-h-[200px] md:min-w-[200px] max-w-full items-start justify-start gap-2 overflow-x-auto overflow-y-hidden rounded-2xl border-2 border-(--border-color) bg-(--darker-bg-color) p-4",children:[!r&&t.map((d,c)=>e.jsx(W,{src:d},c)),r&&e.jsx(q,{type:o,videoId:s})]})}function Z(t){if(!t)return"";const r=[];return t=t.replace(/```([\s\S]*?)```/g,(s,o)=>(r.push(o),`@@CODEBLOCK${r.length-1}@@`)),t=t.replace(/!\[(.*?)\]\((.*?)\)/g,'<img src="$2" alt="$1" />'),t=t.replace(/^---$/gim,"<hr />"),t=t.replace(/^> (.*$)/gim,"<blockquote>$1</blockquote>"),t=t.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>"),t=t.replace(/^\- \[x\] (.*$)/gim,'<li><input type="checkbox" checked disabled /> $1</li>'),t=t.replace(/\*\*(.*?)\*\*/gim,"<strong>$1</strong>"),t=t.replace(/\*(.*?)\*/gim,"<em>$1</em>"),t=t.replace(/`([^`]+)`/g,(s,o)=>`<code>${o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code>`),t=t.replace(/^\- (.*$)/gim,"<li>$1</li>"),t=t.replace(/(<li>.*<\/li>)/gim,"<ul>$1</ul>"),t=t.replace(/\[(.*?)\]\((.*?)\)/gim,'<a href="$2">$1</a>'),t=t.replace(/\n/g,"<br />"),t=t.replace(/@@CODEBLOCK(\d+)@@/g,(s,o)=>`<pre><code>${r[parseInt(o,10)].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code></pre>`),t=t.replace(/^\- \[ \] (.*$)/gim,'<li><input type="checkbox" disabled /> $1</li>'),t=t.replace(/^\- \[x\] (.*$)/gim,'<li><input type="checkbox" checked disabled /> $1</li>'),t=t.replace(/((?:\|.*\|\n)+)/g,s=>{const o=s.trim().split(`
`);if(o.length<2)return s;const d=o[0];if(!o[1].includes("---"))return s;const l=d.split("|").slice(1,-1).map(h=>h.trim()),u=o.slice(2);let m="<thead><tr>";l.forEach(h=>{m+=`<th>${h}</th>`}),m+="</tr></thead>";let n="<tbody>";return u.forEach(h=>{const f=h.split("|").slice(1,-1).map(x=>x.trim());n+="<tr>",f.forEach(x=>{n+=`<td>${x}</td>`}),n+="</tr>"}),n+="</tbody>",`<table>${m}${n}</table>`}),t}const U=i.lazy(()=>I(()=>import("./MarkdownContent-CQyDwfPW.js"),__vite__mapDeps([3,1,2])));class Y extends B.Component{state={hasError:!1};static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?e.jsx("div",{className:"not-prose block w-full py-2",dir:this.props.dir,dangerouslySetInnerHTML:{__html:this.props.fallbackHTML}}):this.props.children}}function Q({body:t,dir:r}){const s=Z(t);return e.jsx("div",{className:`not-prose block w-full py-2 ${r}`,children:e.jsx(Y,{fallbackHTML:s,dir:r,children:e.jsx(i.Suspense,{fallback:e.jsx("div",{dir:r,dangerouslySetInnerHTML:{__html:s}}),children:e.jsx(U,{dir:r,content:t})})})})}function X({goal:t}){const r=t.startsWith("âœ…");return e.jsx("h1",{className:`${r?"border-green-400/30 bg-green-700/70 text-green-100":"border-(--border-color)/70 bg-(--darker-bg-color)/30"} rounded-lg border-2 p-2 px-3`,children:t})}function ee({goals:t}){return e.jsx("div",{className:"flex flex-col gap-2",children:t.map((r,s)=>e.jsx(X,{goal:r},s))})}const te="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='256'%20height='256'%20viewBox='0%200%20256%20256'%3e%3cpath%20fill='%23facc15'%20d='M208%20144a15.78%2015.78%200%200%201-10.42%2014.94L146%20178l-19%2051.62a15.92%2015.92%200%200%201-29.88%200L78%20178l-51.62-19a15.92%2015.92%200%200%201%200-29.88L78%20110l19-51.62a15.92%2015.92%200%200%201%2029.88%200L146%20110l51.62%2019A15.78%2015.78%200%200%201%20208%20144m-56-96h16v16a8%208%200%200%200%2016%200V48h16a8%208%200%200%200%200-16h-16V16a8%208%200%200%200-16%200v16h-16a8%208%200%200%200%200%2016m88%2032h-8v-8a8%208%200%200%200-16%200v8h-8a8%208%200%200%200%200%2016h8v8a8%208%200%200%200%2016%200v-8h8a8%208%200%200%200%200-16'/%3e%3c/svg%3e",M="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='32'%20height='32'%20viewBox='0%200%2032%2032'%3e%3cpath%20fill='%23c1caf5'%20d='M16%202C8.2%202%202%208.2%202%2016s6.2%2014%2014%2014s14-6.2%2014-14S23.8%202%2016%202m5.4%2021L16%2017.6L10.6%2023L9%2021.4l5.4-5.4L9%2010.6L10.6%209l5.4%205.4L21.4%209l1.6%201.6l-5.4%205.4l5.4%205.4z'/%3e%3c/svg%3e";function re({id:t,storyid:r,post:s,handleEditPost:o,setShowEditPost:d}){const[c,l]=i.useState(s?.title??""),[u,m]=i.useState(s?.body??""),[n,h]=i.useState(s?.images??null),[f,x]=i.useState(s?.special??!1),[b,y]=i.useState(s?.secret??!1),[a,p]=i.useState(s?.dir??"rtl"),[g,j]=i.useState(!1),{token:N}=E(),{type:$}=L(),v={"":"",week:"Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹",blog:"Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©",projects:"Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹",special:"Ø§Ù„Ø®Ø§Øµ",goal:"Ø§Ù„Ø£Ù‡Ø¯Ø§Ù"};async function S(w){w.preventDefault();const C={id:t,title:c,body:u,images:n,storyid:r,type:$??"week",special:f,secret:b,dir:a};try{j(!0),(await fetch(`${k}/posts/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer ${N}`},body:JSON.stringify({...C})})).ok?(l(""),m(""),o(C),d(!1)):alert("Failed to edit post.")}catch(P){console.error(P),alert("Server error.")}finally{j(!1)}}return e.jsxs("div",{className:"flex edit-post flex-col overflow-y-auto z-900 md:flex-row md:justify-center pt-10 bg-(--darker-bg-color) gap-5 fixed top-0 left-0 h-dvh w-full",children:[e.jsxs("form",{onSubmit:S,className:"flex relative min-w-[450px] max-w-full min-h-fit overflow-y-auto pt-15 border border-(--border-color) h-fit bg-(--bg-color) flex-col gap-4 p-5",children:[e.jsxs("small",{children:["Ø³ÙƒØ´Ù† ",v[$??""]]}),e.jsx("button",{className:"absolute top-4 right-4 cursor-pointer hover:brightness-110 transition",onClick:()=>d(!1),children:e.jsx("img",{src:M,width:25,height:25})}),e.jsx("input",{type:"text",value:c,onChange:w=>l(w.target.value),placeholder:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",className:"p-2 rounded border border-(--border-color)",disabled:g}),e.jsxs("select",{value:a,className:"p-2 rounded border border-(--border-color)",onChange:w=>p(w.target.value),children:[e.jsx("option",{className:"bg-(--darker-bg-color)",value:"rtl",children:"Arabic"}),e.jsx("option",{className:"bg-(--darker-bg-color)",value:"ltr",children:"English"})]}),e.jsx("textarea",{dir:a,value:u,onChange:w=>m(w.target.value),placeholder:"Ø§Ù„Ù…Ø­ØªÙˆÙ‰",className:"p-2 rounded border border-(--border-color)",rows:5,disabled:g}),e.jsx("textarea",{dir:"ltr",value:n&&n.length>0?n.join(", "):"",onChange:w=>h(w.target.value.split(", ").map(C=>C)),placeholder:"Images (comma separated)",className:"p-2 rounded border border-(--border-color)",rows:5,disabled:g}),e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>x(!f),children:["âœ¨",e.jsx("div",{className:`w-10 h-5 rounded-full transition-colors duration-300 ${f?"bg-(--accent-color)":"bg-gray-400/50"} relative`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 absolute top-0.5 ${f?"left-5":"left-0.5"}`})}),e.jsx("span",{className:"font-semibold text-sm",children:f?"Special":"Normal"})]}),e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>y(!b),children:["ðŸ”’",e.jsx("div",{className:`w-10 h-5 rounded-full transition-colors duration-300 ${b?"bg-(--accent-color)":"bg-gray-400/50"} relative`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 absolute top-0.5 ${b?"left-5":"left-0.5"}`})}),e.jsx("span",{className:"font-semibold text-sm",children:b?"Secret":"Normal"})]}),e.jsx("button",{type:"submit",className:`bg-(--accent-color) font-bold p-2 rounded hover:brightness-95 text-black cursor-pointer transition ${g?"opacity-50 cursor-not-allowed":""}`,disabled:g,children:g?"Ø¬Ø§Ø± Ø§Ù„Ø­ÙØ¸..":"Ø­ÙØ¸"})]}),e.jsx(T,{title:c,body:u,dir:a,storyid:r,images:n||[],type:$||"",special:f,secret:b,isEditting:!0,handleDeletePost:()=>{}})]})}function T({title:t,id:r,time:s,images:o,body:d,dir:c,type:l,special:u,secret:m,storyid:n,isEditting:h=!1,isCreating:f=!1,handleEditPost:x,handleDeletePost:b}){const[y,a]=i.useState(!1),{isAdmin:p,token:g}=E();async function j(N){if(!confirm("Delete post?"))return;(await fetch(`${k}/posts/${N}`,{method:"DELETE",headers:{authorization:`Bearer ${g}`,"Content-Type":"application/json"}})).ok&&(b(N),alert("Deleted!"))}return e.jsxs("div",{className:`${u?"text-yellow-200":""} 
       ${m?"text-fuchsia-200":""} 
       flex post relative px-3 flex-col items-start 
       justify-start gap-4 w-full 
       md:max-w-4xl border-b-2 h-fit
       border-(--border-color) py-5 pt-10`,children:[p&&!h&&!f&&e.jsxs("div",{className:"absolute left-2 top-8 bg-(--darker-bg-color) rounded-full p-2 px-4 border border-(--border-color)/50 flex gap-2",children:[e.jsx("button",{className:"cursor-pointer p-2 bg-(--accent-color) text-black rounded-full hover:brightness-95 transition",onClick:()=>a(!0),children:e.jsx("img",{src:A,width:20,height:20})}),e.jsx("button",{className:"cursor-pointer p-2 bg-red-300 text-black rounded-full hover:brightness-95 transition",onClick:()=>{j(r??0)},children:e.jsx("img",{src:O,width:20,height:20})})]}),y&&p&&e.jsx(re,{id:r??0,storyid:n,post:{storyid:n,title:t,body:d,images:o,dir:c,type:l,special:u,secret:m},handleEditPost:x||(()=>{}),setShowEditPost:a}),t.trim()!==""&&e.jsx(F,{title:t}),e.jsxs("div",{className:"flex gap-2 items-center justify-center",children:[r&&r>436&&e.jsx(J,{time:s||""}),u&&e.jsx("span",{className:"bg-yellow-300/10 border-2 border-yellow-300/20 rounded-full p-2",children:e.jsx("img",{src:te,width:26})}),m&&e.jsx("span",{className:"bg-fuchsia-300/10 border-2 border-fuchsia-300/20 rounded-full p-2",children:e.jsx("img",{src:z,width:26})})]}),l==="goal"?e.jsx(ee,{goals:d.split(`
`)}):f||h||r&&r>=676?e.jsx(Q,{body:d,dir:c}):e.jsx("pre",{children:d}),o&&o.length>0&&e.jsx(K,{images:o})]})}function _({storyid:t,handleCreatePost:r,setShowCreatePost:s}){const[o,d]=i.useState(""),[c,l]=i.useState(""),[u,m]=i.useState(null),[n,h]=i.useState(!1),[f,x]=i.useState(!1),[b,y]=i.useState("rtl"),[a,p]=i.useState(!1),{token:g}=E(),{type:j}=L(),N={"":"",week:"Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹",blog:"Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©",projects:"Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹",special:"Ø§Ù„Ø®Ø§Øµ",goal:"Ø§Ù„Ø£Ù‡Ø¯Ø§Ù"};async function $(v){v.preventDefault();const S={title:o,body:c,images:u,storyid:t,type:j??"week",special:n,secret:f,dir:b};try{p(!0),(await fetch(`${k}/posts`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${g}`},body:JSON.stringify({...S})})).ok?(d(""),l(""),r(S),s(!1)):alert("Failed to create post.")}catch(w){console.error(w),alert("Server error.")}finally{p(!1)}}return e.jsxs("div",{className:"flex flex-col overflow-y-auto z-999 md:flex-row md:justify-center pt-10 bg-(--darker-bg-color) gap-5 fixed inset-0 w-full",children:[e.jsxs("form",{onSubmit:$,className:"flex relative min-w-[450px] max-w-full min-h-fit overflow-y-auto pt-15 border border-(--border-color) h-fit bg-(--bg-color) flex-col gap-4 p-5",children:[e.jsxs("h1",{className:"text-xl font-bold",children:["Ø£Ù†Ø´Ø¦ Ù…Ù†Ø´ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø³ØªÙˆØ±ÙŠ Ø±Ù‚Ù… ",t]}),e.jsxs("small",{children:["Ø³ÙƒØ´Ù† ",N[j??""]]}),e.jsx("button",{className:"absolute top-4 right-4 cursor-pointer hover:brightness-110 transition",onClick:()=>s(!1),children:e.jsx("img",{src:M,width:25,height:25})}),e.jsx("input",{type:"text",value:o,onChange:v=>d(v.target.value),placeholder:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",className:"p-2 rounded border border-(--border-color)",disabled:a}),e.jsxs("select",{value:b,className:"p-2 rounded border border-(--border-color)",onChange:v=>y(v.target.value),children:[e.jsx("option",{className:"bg-(--darker-bg-color)",value:"rtl",children:"Ø¹Ø±Ø¨ÙŠ"}),e.jsx("option",{className:"bg-(--darker-bg-color)",value:"ltr",children:"Ø§Ù†Ø¬Ù„Ø´"})]}),e.jsx("textarea",{dir:b,value:c,onChange:v=>l(v.target.value),placeholder:"Ø§Ù„Ù…Ø­ØªÙˆÙ‰",className:"p-2 rounded border border-(--border-color)",rows:5,disabled:a}),e.jsx("textarea",{dir:"ltr",value:u&&u.length>0?u.join(", "):"",onChange:v=>m(v.target.value.split(", ").map(S=>S)),placeholder:"Images (comma separated)",className:"p-2 rounded border border-(--border-color)",rows:5,disabled:a}),e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>h(!n),children:["âœ¨",e.jsx("div",{className:`w-10 h-5 rounded-full transition-colors duration-300 ${n?"bg-(--accent-color)":"bg-gray-400/50"} relative`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 absolute top-0.5 ${n?"left-5":"left-0.5"}`})}),e.jsx("span",{className:"font-semibold text-sm",children:n?"Special":"Normal"})]}),e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer select-none",onClick:()=>x(!f),children:["ðŸ”’",e.jsx("div",{className:`w-10 h-5 rounded-full transition-colors duration-300 ${f?"bg-(--accent-color)":"bg-gray-400/50"} relative`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-300 absolute top-0.5 ${f?"left-5":"left-0.5"}`})}),e.jsx("span",{className:"font-semibold text-sm",children:f?"Secret":"Normal"})]}),e.jsx("button",{type:"submit",className:`bg-(--accent-color) font-bold p-2 rounded hover:brightness-95 text-black cursor-pointer transition ${a?"opacity-50 cursor-not-allowed":""}`,disabled:a,children:a?"Ø¬Ø§Ø± Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡..":"Ø£Ù†Ø´Ø¦ Ø§Ù„Ù…Ù†Ø´ÙˆØ±"})]}),e.jsx(T,{title:o,body:c,storyid:t,dir:b,images:u||[],type:j||"",special:n,secret:f,isCreating:!0,handleDeletePost:()=>{}})]})}const se=async(t,r)=>{const s=new Date().toLocaleTimeString(),o=new Date().toLocaleDateString(),d=navigator.platform+"";await fetch(`${k}/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitedAt:`${s} - ${o}`,os:d,url:r,username:t})})};function ae(){const{type:t,count:r}=H(),{setType:s}=L(),{isAdmin:o,user:d,token:c}=E(),[l,u]=i.useState(!1);function m(a){h(p=>p===null?[a]:[a,...p])}i.useEffect(()=>{if(!o&&t){async function a(){await se(d?.username??"guest - ",t&&r?`${t} - ${r}`:"Home")}a()}},[t,r]),i.useEffect(()=>{t&&s(t)},[t,s]);const[n,h]=i.useState(null),[f,x]=i.useState(!0),[b,y]=i.useState("");return i.useEffect(()=>{async function a(){try{x(!0),h(null);const p=await fetch(`${k}/posts?type=${t}&count=${r}`,{method:"GET",headers:{"Content-Type":"application/json",authorization:`Bearer ${c}`}});if(p.ok){const g=await p.json();h(g),x(!1),y("")}else x(!1),y("Something went wrong."),h(null)}catch{h(null),x(!1),y("Server Error")}}a()},[r]),R("/mohsaid99/favicons/"+t+".svg"),f?e.jsx("div",{className:"flex flex-1 h-dvh items-center justify-center",children:e.jsx("div",{className:"animate-spin w-7 h-7",children:e.jsx("img",{src:V,alt:"spinning animation",width:28})})}):b?e.jsxs("div",{className:"flex h-screen items-center justify-center",children:["Error: ",b]}):n&&n.length>0?e.jsxs("div",{className:"flex flex-col md:pr-16 min-h-screen items-center justify-center py-25",children:[o&&e.jsx("button",{className:"bg-(--accent-color) rounded-full flex items-center justify-center w-[60px] h-[60px]",onClick:()=>u(!l),children:l?null:e.jsx("img",{src:D,width:30})}),l&&o&&e.jsx(_,{setShowCreatePost:u,handleCreatePost:m,storyid:n[0].storyid}),n.map(a=>e.jsx(T,{storyid:a?.storyid??0,id:a?.id??0,title:a.title??"",time:a.iat??"",images:a?.images??[],body:a.body??"",dir:a.dir,type:a.type,special:a.special??!1,secret:a.secret??!1,handleEditPost:p=>h(g=>g&&g.map(j=>j.id===p.id?p:j)),handleDeletePost:p=>h(n.filter(g=>g.id!==p))},a.id))]}):e.jsxs("div",{className:"flex h-screen items-center justify-center",children:[o&&e.jsx("button",{className:"bg-(--accent-color) rounded-full flex items-center justify-center w-[60px] h-[60px]",onClick:()=>u(!l),children:l?null:e.jsx("img",{src:D,width:30})}),l&&o&&e.jsx(_,{setShowCreatePost:u,handleCreatePost:m,storyid:Number(r)})]})}export{ae as default};
