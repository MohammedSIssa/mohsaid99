import{G as k,r,u as g,j as e,A as w,N as C,e as _,f as N,g as T,c as F,a as S}from"./index-BjffJ4qF.js";function E(t){return k({attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor"},child:[]}]})(t)}function $({story:t}){const[s,o]=r.useState(t.title),[n,i]=r.useState(t.summary??""),[h,c]=r.useState(String(t.year??"")),[a,x]=r.useState(t.count),[d,f]=r.useState(t.type),[u,y]=r.useState(t.special??!1),[b,m]=r.useState(""),{user:j}=g();async function v(l){l.preventDefault();try{const p=await fetch(w+"/stories/"+d+"/"+t.id,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer: ${j?.apikey}`},body:JSON.stringify({title:s,summary:n,special:u,type:d,year:h,count:a})});p.ok&&m("Updated!"),p.status===500&&m("Server Error!"),p.status>=400&&p.status<500&&m("Unauthorized!")}catch(p){console.error(p),m("Client Error!")}}return e.jsxs("form",{onSubmit:v,className:"flex flex-col gap-1 rounded-xl border-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-white/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-white/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{id:"title",value:s,onChange:l=>o(l.target.value)}),e.jsxs("label",{htmlFor:"storyid",dir:"ltr",children:["Story Count:"," "]}),e.jsx("input",{id:"storyid",type:"number",value:a,onChange:l=>x(+l.target.value)}),e.jsxs("label",{htmlFor:"year",dir:"ltr",children:["Story Year:"," "]}),e.jsx("input",{id:"year",type:"number",value:h,onChange:l=>c(l.target.value)}),e.jsxs("label",{htmlFor:"type",dir:"ltr",children:["Type:"," "]}),e.jsxs("select",{className:"[&_option]:bg-black",value:d,onChange:l=>f(l.target.value),children:[e.jsx("option",{value:"week",children:"Weeks"}),e.jsx("option",{value:"goal",children:"Goals"}),e.jsx("option",{value:"blog",children:"Blogs"}),e.jsx("option",{value:"special",children:"Special"})]}),e.jsxs("label",{htmlFor:"summary",dir:"ltr",children:["Summary:"," "]}),e.jsx("textarea",{id:"summary",value:n,onChange:l=>i(l.target.value)}),e.jsx("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-white/10 [&_div]:p-2",children:e.jsxs("div",{className:`flex items-center justify-center gap-2 ${u===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{id:"special",type:"checkbox",className:"opacity-30",checked:u,onChange:l=>y(l.target.checked)})]})}),e.jsx("p",{dir:"ltr",children:b}),e.jsx("button",{type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª"})]})}function z({story:t,onClose:s}){return e.jsxs("div",{className:"absolute top-0 left-0 z-1000 flex w-full flex-col items-center rounded-xl bg-black pt-30 lg:border-0 lg:pt-0",children:[e.jsx($,{story:t}),e.jsx("button",{className:"my-5 w-fit rounded-lg bg-red-500 p-3",onClick:s,children:"Close"})]})}function A({story:t,handleLinkClick:s,onToggleEditPopup:o,onDeleteStory:n}){const i=t.special,[h,c]=r.useState(!1),{isAdmin:a,user:x}=g();async function d(){if(window.confirm("Are you sure you want to delete story "+t.type+" "+t.count))try{(await fetch(w+"/stories/"+t.type+"/"+t.count,{method:"DELETE",headers:{"Content-Type":"application/json",authorization:`Bearer: ${x?.apikey}`}})).ok&&(alert("Deleted story successfully"),n(t.count))}catch{alert("Could not delete story..")}}return e.jsxs(e.Fragment,{children:[e.jsxs(C,{className:`${i?"border-yellow-400/20 bg-yellow-400/40 text-yellow-100 shadow-xl shadow-yellow-400/10":"border-white/20 bg-white/10 shadow-xl shadow-black/10"} relative w-full min-w-[300px] rounded-lg border-2 p-3 pb-8 md:max-w-70`,to:`/${t.type}/${t.count}`,onClick:s,children:[!a()&&!t.seen&&e.jsx("span",{className:"absolute -top-2 -right-1 text-yellow-300",children:e.jsx(_,{size:18})}),e.jsx("h1",{className:"text-xl font-bold",children:t.title}),e.jsx("p",{className:`text-[14px] ${i?"text-yellow-100/70":"text-white/80"}`,children:t?.summary===""?"ðŸ”´":t?.summary}),e.jsxs("div",{className:"year absolute bottom-0 left-1 flex gap-2 font-bold",dir:"ltr",children:[e.jsx("span",{children:t.year}),e.jsxs("span",{children:["#",t.count]}),e.jsxs("div",{className:"admin-controls flex gap-2 pb-1",children:[a()&&t.type!=="stats"&&e.jsx("button",{onClick:()=>{c(!0),o()},className:"rounded bg-blue-500 p-1 px-2",children:e.jsx(N,{})}),a()&&t.type!=="stats"&&e.jsx("button",{onClick:d,className:"rounded bg-red-500 p-1 px-2",children:e.jsx(T,{})})]})]})]}),a()&&h&&e.jsx(z,{story:t,onClose:()=>c(!1)})]})}function D({type:t,count:s,year:o}){const[n,i]=r.useState(!1),[h,c]=r.useState(""),[a,x]=r.useState(""),[d,f]=r.useState(""),[u,y]=r.useState(!1),[b,m]=r.useState(""),{user:j}=g();async function v(l){l.preventDefault();try{const p=await fetch(w+"/stories/"+t,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer: ${j?.apikey}`},body:JSON.stringify({title:a,summary:d,year:b.trim()===""?o:b,count:s,special:u})});p.ok&&c("Story added successfully"),p.ok||c("Error while adding story"),console.log({title:a,summary:d,year:b.trim()===""?o:b,count:s,special:u,type:t})}catch{c("Error while adding story.")}}if(!n)return e.jsx("button",{className:"flex w-full cursor-pointer items-center justify-center rounded-lg border-2 border-white/20 bg-white/10 p-8 shadow-xl shadow-black/10 transition-all duration-200 hover:brightness-150",onClick:()=>i(!0),children:e.jsx(F,{size:30})});if(n)return e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsxs("form",{onSubmit:v,className:"flex flex-col gap-2 rounded-lg border-2 border-white/20 bg-white/10 p-2 **:disabled:opacity-35 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/20 [&_input]:bg-white/20 [&_input]:p-1 [&_input]:focus:outline-0",children:[e.jsx("label",{dir:"ltr",htmlFor:"title",children:"Title:"}),e.jsx("input",{value:a,onChange:l=>x(l.target.value)}),e.jsx("label",{dir:"ltr",htmlFor:"summary",children:"Summary:"}),e.jsx("input",{value:d,onChange:l=>f(l.target.value)}),e.jsx("label",{dir:"ltr",htmlFor:"newYear",children:"Year:"}),e.jsx("input",{dir:"ltr",value:b,onChange:l=>m(l.target.value)}),e.jsxs("div",{className:`flex w-fit items-center justify-center gap-2 rounded p-1 ${u===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{id:"special",type:"checkbox",className:"opacity-30",checked:u,onChange:l=>y(l.target.checked)})]}),e.jsx("p",{children:h}),e.jsx("button",{type:"submit",className:"cursor-pointer bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"Add"})]}),e.jsx("button",{className:"flex w-full cursor-pointer items-center justify-center rounded-lg border-2 border-white/20 bg-white/10 p-8 shadow-xl shadow-black/10 transition-all duration-200 hover:brightness-150",onClick:()=>i(!1),children:e.jsx(S,{size:30})})]})}function H({stories:t,onDeleteStory:s}){const[o,n]=r.useState(!1),i=r.useRef(null),h=()=>{i.current?.scrollTo({top:0,behavior:"smooth"})},{isAdmin:c}=g();return e.jsxs("div",{className:"relative w-full md:w-fit",children:[e.jsx("button",{className:"fixed top-4 left-4 z-100 rounded-xl border-2 border-white/20 bg-white/10 p-3 backdrop-blur-3xl",onClick:()=>n(!o),children:o?e.jsx(S,{size:25}):e.jsx(E,{size:25,strokeWidth:1})}),e.jsxs("div",{ref:i,className:`${o?"fixed flex":"hidden"} stories top-20 z-50 h-screen max-h-[400px] w-full flex-col items-center gap-5 overflow-y-scroll border-2 border-white/20 bg-white/10 p-2 py-10 shadow-xl shadow-black/10 backdrop-blur-2xl md:py-0 md:pt-25 md:pb-5 lg:top-50 lg:left-5 lg:w-fit lg:overflow-y-auto lg:rounded-xl lg:py-5`,children:[c()&&t&&t[0].type!=="stats"&&e.jsx(D,{type:t!==null&&t[0]?.type?t[0].type:"",year:t!==null&&t[0]?.year?t[0].year:"",count:t.length+1}),t.map((a,x)=>e.jsx(A,{onToggleEditPopup:h,story:a,onDeleteStory:s,handleLinkClick:()=>{window.scrollTo({top:0,behavior:"smooth"})}},x))]})]})}const R=async(t,s)=>{const o=new Date().toLocaleTimeString(),n=new Date().toLocaleDateString(),i=navigator.platform+"";await fetch(`${w}/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitedAt:`${o} - ${n}`,os:i,url:s,username:t})})};export{H as S,R as l};
