import{r as s,j as e,u as P,A as F,G as O,a as W,N as B,b as D,T as G,c as U,d as R}from"./index-DQfRmWPI.js";import{H as V,S as Z,l as H}from"./logger-D-HMsB6W.js";function J({body:t,showAllText:r=!1}){const[l,o]=s.useState(t?.length<60);function n(c){return/[\u0600-\u06FF]/.test(c)?"rtl":"ltr"}const i=n(t);return e.jsxs(e.Fragment,{children:[(l||r)&&e.jsx("div",{className:"flex flex-col gap-2 py-2",children:e.jsx("pre",{dir:i,className:"max-w-full md:max-w-[700px]",children:t})}),l||e.jsx("div",{className:"py-2",children:!r&&e.jsxs("pre",{dir:i,className:"max-w-full md:max-w-[700px]",children:[t?.slice(0,60),"..."," ",e.jsx("button",{className:"text-(--font-color)/40 hover:cursor-pointer",onClick:()=>o(!0),children:"عرض المزيد"})]})})]})}function q(t){const r=t.endsWith("Z")?t:t+"Z",l=new Date(r),n=Math.floor((new Date().getTime()-l.getTime())/1e3);if(n<60)return`${n}s ago`;const i=Math.floor(n/60);if(i<60)return`${i}m ago`;const c=Math.floor(i/60);return c<24?`${c}h ago`:l.toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function K({time:t}){return e.jsx("p",{className:"text-(--font-color)/50",children:q(t)})}function Q({title:t}){return e.jsx("h1",{className:"mb-3 text-3xl font-bold md:mb-5 md:text-4xl",children:t})}function X({src:t,alt:r="",className:l=""}){const o=s.useRef(null),[n,i]=s.useState(!1);return s.useEffect(()=>{const c=o.current;if(!c)return;const d=new IntersectionObserver(([g])=>{g.isIntersecting&&(c.src=t,d.disconnect())},{rootMargin:"100px"});return d.observe(c),()=>d.disconnect()},[t]),e.jsx("img",{ref:o,alt:r,onLoad:()=>i(!0),className:`${l} max-h-full rounded-xl object-contain transition-opacity duration-300 ${n?"opacity-100":"opacity-0"}`})}function ee({type:t,videoId:r}){const l=s.useRef(null),[o,n]=s.useState(!1);if(s.useEffect(()=>{const c=new IntersectionObserver(([d])=>{d.isIntersecting&&(n(!0),c.disconnect())});return l.current&&c.observe(l.current),()=>c.disconnect()},[]),!r)return null;const i=`https://www.youtube.com/embed/${r}?autoplay=1&controls=0&loop=1&playlist=${r}&mute=1`;return e.jsx("div",{ref:l,className:`${t} rounded-2xl`,children:o&&e.jsx("iframe",{className:"h-full w-full rounded-2xl",src:i,title:"YouTube video player",allow:"autoplay; encrypted-media",allowFullScreen:!0})})}function te({images:t}){const r=t[0].startsWith("video:"),l=r?t[0].split(":")[2]:null,o=r?t[0].split(":")[1]:null;return e.jsxs("div",{className:"slider flex max-h-full min-h-[200px] w-full max-w-full items-start justify-start gap-2 overflow-x-auto overflow-y-hidden rounded-2xl border-2 border-(--border-color)/30 bg-(--images-box-bg)/20 p-4",children:[!r&&t.map((n,i)=>e.jsx(X,{src:n},i)),r&&e.jsx(ee,{type:o,videoId:l})]})}function se({goal:t}){const r=t.startsWith("✅");return e.jsx("h1",{className:`${r?"border-green-400/30 bg-green-700/70 text-green-100":"border-(--border-color)/70 bg-(--primary-color)/30"} rounded-lg border-2 p-2 px-3`,children:t})}function re({goals:t}){return e.jsx("div",{className:"flex flex-col gap-2",children:t.map((r,l)=>e.jsx(se,{goal:r},l))})}function le({post:t}){const[r,l]=s.useState(t.title??""),[o,n]=s.useState(t.body??""),[i,c]=s.useState(t?.images?.join(", ")??""),[d,g]=s.useState(t.images??[]),[w,j]=s.useState(t.special??!1),[b,v]=s.useState(t.secret??!1),[S,_]=s.useState(t.type??""),[f,u]=s.useState(t.storyid??0),[x,y]=s.useState(!1),[p,C]=s.useState(""),{user:E}=P();async function m(a){a.preventDefault();try{C("Updating..."),y(!0);const h=await fetch(`${F}/posts?fromtype=${t.type}&fromcount=${t.storyid}&id=${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer: ${E?.apikey}`},body:JSON.stringify({title:r,body:o,images:d,special:w,secret:b,type:S,storyid:f})});h.ok&&(y(!1),C("Updated!")),h.status===500&&C("Server Error!"),h.status>=400&&h.status<500&&C("Unauthorized!")}catch(h){console.error(h),C("Client Error!"),y(!1)}}return e.jsxs("form",{onSubmit:m,className:"flex flex-col gap-1 rounded-xl border-2 border-(--border-color)/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl **:disabled:opacity-35 [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-(--border-color)/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-(--border-color)/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-(--border-color)/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{disabled:x,id:"title",value:r,onChange:a=>l(a.target.value)}),e.jsxs("label",{htmlFor:"storyid",dir:"ltr",children:["Story Count:"," "]}),e.jsx("input",{disabled:x,id:"storyid",type:"number",value:f,onChange:a=>u(+a.target.value)}),e.jsxs("label",{htmlFor:"type",dir:"ltr",children:["Type:"," "]}),e.jsxs("select",{disabled:x,className:"[&_option]:bg-black",value:S,onChange:a=>_(a.target.value),children:[e.jsx("option",{value:"week",children:"Weeks"}),e.jsx("option",{value:"goal",children:"Goals"}),e.jsx("option",{value:"blog",children:"Blogs"}),e.jsx("option",{value:"special",children:"Special"})]}),e.jsxs("label",{htmlFor:"body",dir:"ltr",children:["Body:"," "]}),e.jsx("textarea",{disabled:x,id:"body",value:o,onChange:a=>n(a.target.value)}),e.jsxs("label",{htmlFor:"images",dir:"ltr",children:["Images:"," "]}),e.jsx("textarea",{disabled:x,id:"images",dir:"ltr",value:i,onChange:a=>{const h=a.target.value;c(h);const k=h.split(", ").map(I=>I.trim()).filter(Boolean);g(k)}}),e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-(--border-color)/10 [&_div]:p-2",children:[e.jsxs("div",{className:`flex items-center justify-center gap-2 ${w===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{disabled:x,id:"special",type:"checkbox",className:"opacity-30",checked:w,onChange:a=>j(a.target.checked)})]}),e.jsxs("div",{className:`flex items-center justify-center gap-2 ${b===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"secret",dir:"ltr",children:"Secret?"}),e.jsx("input",{disabled:x,id:"secret",type:"checkbox",className:"opacity-30",checked:b,onChange:a=>v(a.target.checked)})]})]}),e.jsx("p",{dir:"ltr",children:p}),e.jsx("button",{disabled:x,type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"حفظ التعديلات"})]})}function oe(t){return O({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M 5.398 10.807 C 5.574 10.931 5.785 10.998 6 10.997 C 6.216 10.998 6.427 10.93 6.602 10.804 C 6.78 10.674 6.915 10.494 6.989 10.286 L 7.436 8.913 C 7.551 8.569 7.744 8.256 8 7.999 C 8.257 7.743 8.569 7.549 8.913 7.434 L 10.304 6.983 C 10.456 6.929 10.594 6.84 10.706 6.724 C 10.817 6.608 10.901 6.467 10.949 6.313 C 10.998 6.159 11.01 5.996 10.985 5.837 C 10.96 5.677 10.898 5.526 10.804 5.394 C 10.67 5.208 10.479 5.071 10.26 5.003 L 8.885 4.556 C 8.541 4.442 8.228 4.249 7.971 3.993 C 7.714 3.736 7.52 3.424 7.405 3.079 L 6.953 1.691 C 6.881 1.489 6.748 1.314 6.571 1.191 C 6.439 1.098 6.286 1.036 6.125 1.012 C 5.965 0.987 5.801 1.001 5.646 1.051 C 5.492 1.101 5.351 1.187 5.236 1.301 C 5.12 1.415 5.033 1.555 4.98 1.708 L 4.523 3.108 C 4.409 3.443 4.22 3.748 3.97 3.999 C 3.721 4.25 3.418 4.441 3.083 4.557 L 1.692 5.005 C 1.541 5.06 1.404 5.149 1.292 5.265 C 1.18 5.381 1.097 5.521 1.048 5.675 C 1 5.829 0.988 5.992 1.013 6.151 C 1.038 6.31 1.099 6.462 1.192 6.593 C 1.32 6.773 1.501 6.908 1.709 6.979 L 3.083 7.424 C 3.524 7.571 3.91 7.845 4.193 8.212 C 4.356 8.423 4.481 8.66 4.564 8.912 L 5.016 10.303 C 5.088 10.507 5.222 10.683 5.398 10.807 Z M 11.535 14.849 C 11.671 14.946 11.834 14.997 12 14.997 C 12.165 14.997 12.326 14.946 12.461 14.851 C 12.601 14.753 12.706 14.613 12.761 14.451 L 13.009 13.689 C 13.063 13.531 13.152 13.387 13.269 13.268 C 13.387 13.15 13.531 13.061 13.689 13.009 L 14.461 12.757 C 14.619 12.703 14.756 12.6 14.852 12.464 C 14.926 12.361 14.974 12.242 14.992 12.117 C 15.011 11.992 14.999 11.865 14.959 11.745 C 14.918 11.625 14.85 11.516 14.76 11.428 C 14.669 11.34 14.559 11.274 14.438 11.236 L 13.674 10.987 C 13.516 10.935 13.372 10.846 13.254 10.729 C 13.136 10.611 13.047 10.467 12.994 10.309 L 12.742 9.536 C 12.689 9.379 12.586 9.242 12.449 9.146 C 12.347 9.073 12.23 9.025 12.106 9.006 C 11.982 8.987 11.855 8.998 11.736 9.037 C 11.616 9.076 11.508 9.142 11.419 9.231 C 11.33 9.319 11.264 9.427 11.224 9.546 L 10.977 10.308 C 10.925 10.466 10.838 10.61 10.721 10.728 C 10.607 10.845 10.467 10.934 10.312 10.987 L 9.539 11.239 C 9.38 11.293 9.242 11.396 9.145 11.533 C 9.047 11.669 8.995 11.833 8.996 12.001 C 8.997 12.169 9.051 12.333 9.15 12.468 C 9.249 12.604 9.388 12.705 9.547 12.757 L 10.31 13.004 C 10.469 13.058 10.614 13.147 10.732 13.265 C 10.851 13.384 10.939 13.528 10.99 13.687 L 11.243 14.461 C 11.298 14.618 11.4 14.753 11.535 14.849 Z"},child:[]}]})(t)}function z({post:t,isPerview:r=!1,isHighlight:l}){const[o,n]=s.useState(!1),{isAdmin:i,isMonmon:c,user:d}=P(),g=t.secret&&(i()||c());async function w(){try{window.confirm(`Are you sure you want to fetch("/posts?type=${t.type}&storyid=${t.storyid}&id=${t.id}"`)&&(await fetch(`${F}/posts?type=${t.type}&storyid=${t.storyid}&id=${t.id}`,{method:"DELETE",headers:{authorization:`Bearer: ${d?.apikey}`}})).ok&&alert("Deleted post!")}catch{alert("Could not delete post!")}}return e.jsxs("div",{className:`${g?"flex":t.secret?"hidden":"flex"} 
         ${t.special&&!l?"special border-yellow-200/70 bg-(--golden-post-bg)/30 text-yellow-200":""}
         ${t.secret?"secret border-fuchsia-300/60 bg-fuchsia-700/20 text-(--font-color)":""} 
         ${!t.secret&&!t.special||l?"border-(--border-color)/50 bg-(--primary-color)/20":""} 
          post relative w-full max-w-full flex-col gap-2 border-t-2 border-b-2 
          p-3 py-5
          shadow-xl shadow-black/10 backdrop-blur-xs 
          md:w-fit md:max-w-[700px] md:min-w-[350px] 
          md:rounded-xl md:border-2 lg:max-w-[900px]`,children:[t.special&&!l&&e.jsx("span",{className:"absolute top-2 left-2",children:e.jsx(oe,{})}),t.secret&&e.jsx("span",{className:"absolute top-2 left-2",children:e.jsx(W,{})}),l&&e.jsx(B,{to:`/week/${t.storyid}`,className:"year absolute top-2 left-2 font-bold",children:`#${t.storyid}`}),!o&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:t?.title??""}),(t?.id??500)>436&&!r&&t?.type!=="goal"&&e.jsx(K,{time:t.iat??""}),t.type!=="goal"&&e.jsx(J,{body:t?.body??"",showAllText:t?.images?.length===0}),t.type==="goal"&&e.jsx(re,{goals:t.body.split(`
`)}),t?.images&&t?.images.length>0&&e.jsx(te,{images:t?.images??[]})]}),o&&e.jsx(le,{post:t}),i()&&!l&&!r&&e.jsxs("div",{className:"absolute -top-15 left-2 flex gap-2 rounded-lg border-2 border-(--border-color)/20 bg-(--primary-color)/20 p-2 px-3 shadow-xl shadow-black/10 [&_button]:cursor-pointer [&_button]:transition-all [&_button]:duration-200 [&_button]:hover:brightness-90",children:[e.jsx("button",{className:"place-items-center rounded-lg bg-blue-600 p-2 text-white backdrop-blur-2xl",onClick:()=>n(!o),children:o?e.jsx(D,{size:18}):e.jsx(G,{size:18})}),e.jsx("button",{className:"place-items-center rounded-lg bg-red-500 p-2 text-white backdrop-blur-2xl",onClick:w,children:e.jsx(V,{size:18})})]})]})}function ae({type:t,storyid:r}){const[l,o]=s.useState(""),[n,i]=s.useState(""),[c,d]=s.useState(""),[g,w]=s.useState([]),[j,b]=s.useState(!1),[v,S]=s.useState(!1),[_,f]=s.useState(!1),[u,x]=s.useState(""),[y,p]=s.useState(!1),{user:C}=P();async function E(m){m.preventDefault();try{p(!0),x("Adding post..");const a=await fetch(`${F}/posts?type=${t}&storyid=${r}`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer: ${C?.apikey}`},body:JSON.stringify({title:l,body:n,images:g,special:j,secret:v,type:t,storyid:r})});a.ok&&(x("Post added successfully!"),o(""),i(""),S(!1),b(!1),d("")),a.status===500&&x("Server Error!"),a.status>=400&&a.status<500&&x("Unauthorized!")}catch(a){console.error(a),x("Client Error!")}finally{p(!1)}}if(!_)return e.jsx("button",{className:"cursor-pointer rounded-xl border-2 border-(--border-color)/20 bg-white/10 p-10 px-25 transition-all duration-200 hover:brightness-150",onClick:()=>f(!0),children:e.jsx(U,{size:30})});if(_)return e.jsxs("div",{className:"mb-5 flex flex-col items-center gap-5",children:[e.jsxs("form",{onSubmit:E,className:"flex max-w-fit flex-col gap-1 rounded-xl border-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl **:disabled:opacity-35 md:min-w-[400px] [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-white/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-white/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("h1",{className:"font-bold",dir:"ltr",children:["Add a post for ",t," ",r]}),e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{disabled:y,id:"title",value:l,onChange:m=>o(m.target.value)}),e.jsxs("label",{htmlFor:"body",dir:"ltr",children:["Body:"," "]}),e.jsx("textarea",{disabled:y,id:"body",value:n,onChange:m=>i(m.target.value)}),e.jsxs("label",{htmlFor:"images",dir:"ltr",children:["Images:"," "]}),e.jsx("textarea",{disabled:y,id:"images",dir:"ltr",value:c,onChange:m=>{const a=m.target.value;d(a);const h=a.split(", ").map(k=>k.trim()).filter(Boolean);w(h)}}),e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-white/10 [&_div]:p-2",children:[e.jsxs("div",{className:`flex items-center justify-center gap-2 ${j===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{disabled:y,id:"special",type:"checkbox",className:"opacity-30",checked:j,onChange:m=>b(m.target.checked)})]}),e.jsxs("div",{className:`flex items-center justify-center gap-2 ${v===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"secret",dir:"ltr",children:"Secret?"}),e.jsx("input",{id:"secret",type:"checkbox",className:"opacity-30",checked:v,onChange:m=>S(m.target.checked)})]})]}),e.jsx("p",{dir:"ltr",children:u}),e.jsx("button",{type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"اضافة المنشور"})]}),e.jsx(z,{post:{title:l,body:n,images:g,special:j,secret:v,type:t,storyid:r},isPerview:!0,isHighlight:!1}),e.jsx("button",{className:"cursor-pointer rounded-xl border-2 border-white/20 bg-white/10 p-10 px-25 transition-all duration-200 hover:brightness-150",onClick:()=>f(!1),children:e.jsx(D,{size:30})})]})}const ie={week:"الأسابيع",goal:"الأهداف",special:"خاص",stat:"احصائيات",blog:"المدونة",highlight:"أبرز المنشورات"};function ne({posts:t,type:r,isHighlights:l,storyid:o}){const{isAdmin:n}=P();return e.jsxs("div",{className:"flex w-full flex-col items-center pt-20",children:[e.jsxs("div",{className:"mx-auto mb-2 flex gap-2 md:hidden",children:[e.jsx("p",{className:"rounded border-2 border-(--border-color)/50 bg-(--primary-color)/40 p-2 px-5 font-bold",children:ie[r]}),e.jsxs("p",{className:"counter rounded border-2 border-(--border-color)/50 bg-(--primary-color)/40 p-2 px-5 font-bold",children:["#",o]})]}),e.jsx("div",{className:"mb-5",children:n()&&e.jsx(ae,{type:r,storyid:o})}),!n()&&t.length===0&&e.jsx("h1",{className:"text-2xl font-bold",children:"لا توجد منشورات"}),e.jsx("div",{className:"flex w-full flex-col items-center gap-17",children:t.map((i,c)=>e.jsx(z,{post:i,isHighlight:l},c))})]})}function ce(){const{isAdmin:t}=P(),r=Array.from({length:5});return e.jsx("div",{className:`flex w-full flex-col items-center gap-5 overflow-y-hidden ${t()?"pt-66 md:pt-53":"pt-38 md:pt-25"}`,children:r.map((l,o)=>e.jsxs("div",{className:"flex w-full max-w-full animate-pulse flex-col gap-2 border-t-2 border-b-2 border-(--border-color)/40 bg-(--primary-color)/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl odd:min-h-[200px] even:min-h-[350px] even:delay-200 md:w-fit md:max-w-[700px] md:rounded-xl md:border-2 md:odd:min-w-[600px] md:even:min-w-[700px] [&_div]:rounded-lg",children:[e.jsx("div",{className:"mb-5 w-[40%] animate-pulse bg-(--primary-color)/10 p-5"}),e.jsx("div",{className:"w-[70%] animate-pulse bg-(--primary-color)/20 p-2"}),e.jsx("div",{className:"w-[50%] animate-pulse bg-(--primary-color)/20 p-2"}),e.jsx("div",{className:"w-[60%] animate-pulse bg-(--primary-color)/20 p-2"}),e.jsx("div",{className:"h-[200px] max-h-[60%] w-full animate-pulse bg-(--primary-color)/20 p-2"})]},o))})}function de(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة الأهداف"}),e.jsx("p",{children:"هنا بكتب أهداف كل ربع بالسنة"}),e.jsx("p",{children:"الهدف هنا التركيز على أهدافي ومحاولة تحقيقها"})]})}function ue(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة الأسابيع أو اليوميات"}),e.jsx("p",{children:"هنا بكتب آخر الأحداث اللي بتصير معي"}),e.jsx("p",{children:"الرحلة موثقة هنا من أول يوم بسنة 2025"})]})}function xe(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة المحتوى الخاص"}),e.jsx("p",{children:"الجزء هاد كان هدية الـ11 شهر"}),e.jsx("p",{children:" المحتوى هنا محدش بيقدر يشوفو غير شخص واحد"}),e.jsx("p",{children:"هان بكتب آخر التطورات بشكل شخصي اكتر"})]})}function me(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة أفضل الأحداث"}),e.jsx("p",{children:"هنا المنشورات المميزة اللي حصلت خلال السنة"})]})}function pe({type:t}){return e.jsxs("div",{children:[t==="week"&&e.jsx(ue,{}),t==="goal"&&e.jsx(de,{}),t==="special"&&e.jsx(xe,{}),t==="highlight"&&e.jsx(me,{})]})}function M(){return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-5 p-10",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"هاد الصفحة غير موجودة"}),e.jsx(B,{to:"/",className:"text-violet-200 underline",replace:!0,children:"اضغط هنا"})]})}function fe({toType:t=null}){const[r,l]=s.useState(null),[o,n]=s.useState(null),[i,c]=s.useState(new Date().getFullYear()),[d,g]=s.useState(!0),[w,j]=s.useState(!1),[b,v]=s.useState(!1),[S,_]=s.useState(!1),{type:f,storyid:u}=R(),{isAdmin:x,user:y}=P(),p=s.useMemo(()=>t??f??"",[t,f]),C=s.useMemo(()=>!d,[d]),E=s.useMemo(()=>!b&&u!==void 0,[b,u]),m=s.useMemo(()=>!d&&u===void 0,[d,u]),a=s.useMemo(()=>b&&!d&&u!==void 0,[b,d,u]),h=s.useMemo(()=>u!==void 0?parseInt(u):0,[u]),k=s.useMemo(()=>f==="highlight",[f]),I=s.useCallback($=>{l(T=>T?.filter(N=>N.count!==$)??null)},[]);s.useEffect(()=>{const $=["week","blog","goal","special","highlight"];async function T(){try{g(!0);const N=await fetch(`${F}/stories?type=${p}&year=${i}`);if(N.ok){const L=await N.json();l(L),j(!1)}else j(!0)}catch(N){j(!0),console.error("Failed to load stories:",N)}finally{g(!1)}}$.includes(p)&&T()},[p,i]),s.useEffect(()=>{async function $(N){try{v(!0);const L=await fetch(N);if(L.ok){const Y=await L.json();n(Y),_(!1),x()||await H(y?.username??"guest",`${p} - ${u}`)}}catch(L){_(!0),console.error("Failed to load posts:",L)}finally{v(!1)}}if(u===void 0)return;const T=k?`${F}/posts?type=week&year=${u}&special=true`:`${F}/posts?type=${p}&storyid=${u}`;$(T)},[u,p,k,x,y?.username]);const A=["week","blog","goal","special","highlight"];return t&&!A.includes(t)?e.jsx(M,{}):!t&&f&&!A.includes(f)?e.jsx(M,{}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 md:flex-row",children:[w&&e.jsx("div",{className:"p-4 text-red-500",children:"Failed to load stories"}),d&&e.jsx("div",{className:"flex items-center justify-center p-40",children:e.jsx("span",{className:"h-20 w-20 animate-spin rounded-xl border-2 border-(--border-color)/20 bg-(--primary-color)/20"})}),C&&e.jsx(Z,{type:p,stories:r??[],onDeleteStory:I,currentYear:i,setCurrentYear:$=>c(parseInt($))}),a&&e.jsx(ce,{}),m&&e.jsx(pe,{type:r?.[0]?.type}),S&&e.jsx("div",{className:"p-4 text-red-500",children:"Failed to load posts"}),E&&e.jsx(ne,{posts:o??[],type:p,storyid:h,isHighlights:k})]})})}export{fe as default};
