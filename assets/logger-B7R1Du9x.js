import{G as _,r,u as j,j as e,A as v,N,d as $,M as T,b as F,a as k}from"./index-jJMpe9oM.js";function E(t){return _({attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor"},child:[]}]})(t)}function z({story:t}){const[l,u]=r.useState(t.title),[s,d]=r.useState(t.summary??""),[o,p]=r.useState(String(t.year??"")),[i,h]=r.useState(t.count),[b,x]=r.useState(t.type),[c,w]=r.useState(t.special??!1),[f,g]=r.useState(""),{user:y}=j();async function S(a){a.preventDefault();try{const m=await fetch(`${v}/stories?storyid=${t.id}&fromyear=${t.year}&fromtype=${t.type}`,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer: ${y?.apikey}`},body:JSON.stringify({title:l,summary:s,special:c,type:b,year:o,count:i})});m.ok&&g("Updated!"),m.status===500&&g("Server Error!"),m.status>=400&&m.status<500&&g("Unauthorized!")}catch(m){console.error(m),g("Client Error!")}}return e.jsxs("form",{onSubmit:S,className:"flex flex-col gap-1 rounded-xl border-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-white/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-white/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{id:"title",value:l,onChange:a=>u(a.target.value)}),e.jsxs("label",{htmlFor:"storyid",dir:"ltr",children:["Story Count:"," "]}),e.jsx("input",{id:"storyid",type:"number",value:i,onChange:a=>h(+a.target.value)}),e.jsxs("label",{htmlFor:"year",dir:"ltr",children:["Story Year:"," "]}),e.jsx("input",{id:"year",type:"number",value:o,onChange:a=>p(a.target.value)}),e.jsxs("label",{htmlFor:"type",dir:"ltr",children:["Type:"," "]}),e.jsxs("select",{className:"[&_option]:bg-black",value:b,onChange:a=>x(a.target.value),children:[e.jsx("option",{value:"week",children:"Weeks"}),e.jsx("option",{value:"goal",children:"Goals"}),e.jsx("option",{value:"blog",children:"Blogs"}),e.jsx("option",{value:"special",children:"Special"})]}),e.jsxs("label",{htmlFor:"summary",dir:"ltr",children:["Summary:"," "]}),e.jsx("textarea",{id:"summary",value:s,onChange:a=>d(a.target.value)}),e.jsx("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-white/10 [&_div]:p-2",children:e.jsxs("div",{className:`flex items-center justify-center gap-2 ${c===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{id:"special",type:"checkbox",className:"opacity-30",checked:c,onChange:a=>w(a.target.checked)})]})}),e.jsx("p",{dir:"ltr",children:f}),e.jsx("button",{type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª"})]})}function A({story:t,onClose:l}){return e.jsxs("div",{className:"absolute top-0 left-0 z-1000 flex w-full flex-col items-center rounded-xl bg-black pt-30 lg:border-0 lg:pt-0",children:[e.jsx(z,{story:t}),e.jsx("button",{className:"my-5 w-fit rounded-lg bg-red-500 p-3",onClick:l,children:"Close"})]})}function D({story:t,handleLinkClick:l,onToggleEditPopup:u,onDeleteStory:s,currentYear:d}){const o=t.special,[p,i]=r.useState(!1),{isAdmin:h,user:b}=j();async function x(){if(window.confirm("Are you sure you want to delete story "+t.type+" "+t.count))try{(await fetch(`${v}/stories?type=${t.type}&count=${t.count}&year=${d}&id=${t.id}`,{method:"DELETE",headers:{"Content-Type":"application/json",authorization:`Bearer: ${b?.apikey}`}})).ok&&(alert("Deleted story successfully"),s(t.count))}catch{alert("Could not delete story..")}}return e.jsxs(e.Fragment,{children:[e.jsxs(N,{className:`${o?"border-yellow-400/20 bg-yellow-400/40 text-yellow-100 shadow-xl shadow-yellow-400/10":"border-white/20 bg-white/10 shadow-xl shadow-black/10"} relative w-full min-w-[300px] rounded-lg border-2 p-3 pb-8 md:max-w-70`,to:`/${t.type}/${t.count}`,onClick:l,children:[e.jsx("h1",{className:"text-xl font-bold",children:t.title}),e.jsx("p",{className:`text-[14px] ${o?"text-yellow-100/70":"text-white/80"}`,children:t?.summary===""?"ðŸ”´":t?.summary}),e.jsxs("div",{className:"year absolute bottom-0 left-1 flex gap-2 font-bold",dir:"ltr",children:[e.jsx("span",{children:t.year}),e.jsxs("span",{children:["#",t.count]}),e.jsxs("div",{className:"admin-controls flex gap-2 pb-1",children:[h()&&t.type!=="stats"&&e.jsx("button",{onClick:()=>{i(!0),u()},className:"rounded bg-blue-500 p-1 px-2",children:e.jsx($,{})}),h()&&t.type!=="stats"&&e.jsx("button",{onClick:x,className:"rounded bg-red-500 p-1 px-2",children:e.jsx(T,{})})]})]})]}),h()&&p&&e.jsx(A,{story:t,onClose:()=>i(!1)})]})}function P({type:t,count:l,year:u}){const[s,d]=r.useState(!1),[o,p]=r.useState(""),[i,h]=r.useState(""),[b,x]=r.useState(""),[c,w]=r.useState(!1),[f,g]=r.useState(u),[y,S]=r.useState(l),{user:a}=j();async function m(n){n.preventDefault();try{const C=await fetch(`${v}/stories?type=${t}&year=${t!=="special"?f:String(f).split("/")[2]}`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer: ${a?.apikey}`},body:JSON.stringify({title:i,summary:b,year:t!=="special"?f:String(f).split("/")[2],count:y,special:c,type:t})});C.ok&&p("Story added successfully"),C.ok||p("Error while adding story")}catch{p("Error while adding story.")}}if(!s)return e.jsx("button",{className:"flex w-full cursor-pointer items-center justify-center rounded-lg border-2 border-white/20 bg-white/10 p-8 shadow-xl shadow-black/10 transition-all duration-200 hover:brightness-150",onClick:()=>d(!0),children:e.jsx(F,{size:30})});if(s)return e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsxs("form",{onSubmit:m,className:"flex flex-col gap-2 rounded-lg border-2 border-white/20 bg-white/10 p-2 **:disabled:opacity-35 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/20 [&_input]:bg-white/20 [&_input]:p-1 [&_input]:focus:outline-0",children:[e.jsx("label",{dir:"ltr",htmlFor:"title",children:"Title:"}),e.jsx("input",{value:i,onChange:n=>h(n.target.value)}),e.jsx("label",{dir:"ltr",htmlFor:"summary",children:"Summary:"}),e.jsx("input",{value:b,onChange:n=>x(n.target.value)}),e.jsx("label",{dir:"ltr",htmlFor:"newYear",children:"Year:"}),e.jsx("input",{dir:"ltr",value:f,onChange:n=>g(n.target.value)}),e.jsx("label",{dir:"ltr",children:"Count:"}),e.jsx("input",{dir:"ltr",value:y,onChange:n=>S(Number(n.target.value))}),e.jsxs("div",{className:`flex w-fit items-center justify-center gap-2 rounded p-1 ${c===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{id:"special",type:"checkbox",className:"opacity-30",checked:c,onChange:n=>w(n.target.checked)})]}),e.jsx("p",{children:o}),e.jsx("button",{type:"submit",className:"cursor-pointer bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"Add"})]}),e.jsx("button",{className:"flex w-full cursor-pointer items-center justify-center rounded-lg border-2 border-white/20 bg-white/10 p-8 shadow-xl shadow-black/10 transition-all duration-200 hover:brightness-150",onClick:()=>d(!1),children:e.jsx(k,{size:30})})]})}function B({type:t,stories:l,onDeleteStory:u,currentYear:s,setCurrentYear:d}){const[o,p]=r.useState(!1),i=r.useRef(null),h=()=>{i.current?.scrollTo({top:0,behavior:"smooth"})},{isAdmin:b}=j();return e.jsxs("div",{className:"relative w-full md:w-fit",children:[e.jsx("button",{className:"fixed top-4 left-4 z-100 rounded-xl border-2 border-white/20 bg-white/10 p-3 backdrop-blur-3xl",onClick:()=>p(!o),children:o?e.jsx(k,{size:25}):e.jsx(E,{size:25,strokeWidth:1})}),e.jsxs("div",{ref:i,className:`${o?"fixed flex":"hidden"} stories top-20 z-50 h-[75%] w-full min-w-[300px] flex-col items-center gap-5 overflow-y-scroll border-t-2 border-b-2 border-white/20 bg-white/10 p-2 py-10 shadow-xl shadow-black/10 backdrop-blur-2xl md:py-0 md:pt-25 md:pb-5 lg:left-5 lg:max-h-[80%] lg:w-fit lg:overflow-y-auto lg:rounded-xl lg:border-2 lg:py-5`,children:[b()&&l&&l[0]?.type!=="stats"&&e.jsx(P,{type:t,year:t!=="sepecial"?l!==null&&l[0]?.year?l[0]?.year:"":s,count:l.length>0?l[l.length-1].count+1:1}),l?e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"rounded-lg border-2 border-white/20 bg-white/10 p-2 px-5 font-bold shadow-xl shadow-black/10 focus:outline-0 [&_option]:bg-white/10 [&_option]:text-black",value:s,onChange:x=>d(x.target.value),children:[e.jsx("option",{value:"2026",children:"2026"}),e.jsx("option",{value:"2025",children:"2025"})]}),l.map((x,c)=>e.jsx(D,{onToggleEditPopup:h,story:x,currentYear:s,onDeleteStory:u,handleLinkClick:()=>{window.scrollTo({top:0,behavior:"smooth"})}},c))]}):null]})]})}const M=async(t,l)=>{const u=new Date().toLocaleTimeString(),s=new Date().toLocaleDateString(),d=navigator.platform+"";await fetch(`${v}/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitedAt:`${u} - ${s}`,os:d,url:l,username:t})})};export{B as S,M as l};
