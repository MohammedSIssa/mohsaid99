import{G as _,r,u as j,j as e,A as v,N,d as $,M as T,b as F,a as k}from"./index-CZE0Ms7r.js";function E(t){return _({attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor"},child:[]}]})(t)}function z({story:t}){const[l,u]=r.useState(t.title),[o,d]=r.useState(t.summary??""),[s,p]=r.useState(String(t.year??"")),[n,x]=r.useState(t.count),[h,b]=r.useState(t.type),[c,w]=r.useState(t.special??!1),[f,g]=r.useState(""),{user:y}=j();async function S(a){a.preventDefault();try{const m=await fetch(`${v}/stories?storyid=${t.id}&fromyear=${t.year}&fromtype=${t.type}`,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer: ${y?.apikey}`},body:JSON.stringify({title:l,summary:o,special:c,type:h,year:s,count:n})});m.ok&&g("Updated!"),m.status===500&&g("Server Error!"),m.status>=400&&m.status<500&&g("Unauthorized!")}catch(m){console.error(m),g("Client Error!")}}return e.jsxs("form",{onSubmit:S,className:"flex flex-col gap-1 rounded-xl border-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-white/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-white/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{id:"title",value:l,onChange:a=>u(a.target.value)}),e.jsxs("label",{htmlFor:"storyid",dir:"ltr",children:["Story Count:"," "]}),e.jsx("input",{id:"storyid",type:"number",value:n,onChange:a=>x(+a.target.value)}),e.jsxs("label",{htmlFor:"year",dir:"ltr",children:["Story Year:"," "]}),e.jsx("input",{id:"year",type:"number",value:s,onChange:a=>p(a.target.value)}),e.jsxs("label",{htmlFor:"type",dir:"ltr",children:["Type:"," "]}),e.jsxs("select",{className:"[&_option]:bg-black",value:h,onChange:a=>b(a.target.value),children:[e.jsx("option",{value:"week",children:"Weeks"}),e.jsx("option",{value:"goal",children:"Goals"}),e.jsx("option",{value:"blog",children:"Blogs"}),e.jsx("option",{value:"special",children:"Special"})]}),e.jsxs("label",{htmlFor:"summary",dir:"ltr",children:["Summary:"," "]}),e.jsx("textarea",{id:"summary",value:o,onChange:a=>d(a.target.value)}),e.jsx("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-white/10 [&_div]:p-2",children:e.jsxs("div",{className:`flex items-center justify-center gap-2 ${c===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{id:"special",type:"checkbox",className:"opacity-30",checked:c,onChange:a=>w(a.target.checked)})]})}),e.jsx("p",{dir:"ltr",children:f}),e.jsx("button",{type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª"})]})}function A({story:t,onClose:l}){return e.jsxs("div",{className:"absolute top-0 left-0 z-1000 flex w-full flex-col items-center rounded-xl bg-black pt-30 lg:border-0 lg:pt-0",children:[e.jsx(z,{story:t}),e.jsx("button",{className:"my-5 w-fit rounded-lg bg-red-500 p-3",onClick:l,children:"Close"})]})}function D({story:t,handleLinkClick:l,onToggleEditPopup:u,onDeleteStory:o,currentYear:d}){const s=t.special,[p,n]=r.useState(!1),{isAdmin:x,user:h}=j();async function b(){if(window.confirm("Are you sure you want to delete story "+t.type+" "+t.count))try{(await fetch(`${v}/stories?type=${t.type}&count=${t.count}&year=${d}&id=${t.id}`,{method:"DELETE",headers:{"Content-Type":"application/json",authorization:`Bearer: ${h?.apikey}`}})).ok&&(alert("Deleted story successfully"),o(t.count))}catch{alert("Could not delete story..")}}return e.jsxs(e.Fragment,{children:[e.jsxs(N,{className:` ${s?"border-yellow-400/80 bg-linear-to-bl from-yellow-300/60 to-yellow-700 text-yellow-100 shadow-xl shadow-yellow-400/20":"border-white/50 bg-linear-to-b from-white/30 via-white/10 to-white/0 shadow-xl shadow-black/10"} relative w-full min-w-[300px] rounded-lg border-2 p-3 pb-8 md:max-w-70`,to:`/${t.type}/${t.count}`,onClick:l,children:[e.jsx("h1",{className:"text-xl font-bold",children:t.title}),e.jsx("p",{className:`text-[13px] ${s?"text-yellow-100/70":"text-white/70"}`,children:t?.summary===""?"ðŸ”´":t?.summary}),e.jsx("span",{className:`year absolute -top-4 left-2 flex gap-2 rounded bg-linear-to-b ${s?"from-yellow-700 to-yellow-900 text-yellow-200 shadow-yellow-900":"bg-violet-500 text-[#f3f0ff] shadow-black/20"} px-2 font-bold shadow-md`,children:t.year}),e.jsxs("span",{className:"year absolute bottom-0 left-1 font-bold",children:["#",t.count]}),x()&&t.type!=="stats"&&e.jsx("div",{className:"absolute right-1 -bottom-3 flex gap-1 rounded-lg bg-black/30 p-1 text-white [&_button]:cursor-pointer",children:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{n(!0),u()},className:"rounded bg-linear-to-b from-blue-400 to-blue-700 p-1 px-2",children:e.jsx($,{})}),e.jsx("button",{onClick:b,className:"rounded bg-linear-to-b from-red-400 to-red-700 p-1 px-2",children:e.jsx(T,{})})]})})]}),x()&&p&&e.jsx(A,{story:t,onClose:()=>n(!1)})]})}function P({type:t,count:l,year:u}){const[o,d]=r.useState(!1),[s,p]=r.useState(""),[n,x]=r.useState(""),[h,b]=r.useState(""),[c,w]=r.useState(!1),[f,g]=r.useState(u),[y,S]=r.useState(l),{user:a}=j();async function m(i){i.preventDefault();try{const C=await fetch(`${v}/stories?type=${t}&year=${t!=="special"?f:String(f).split("/")[2]}`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer: ${a?.apikey}`},body:JSON.stringify({title:n,summary:h,year:t!=="special"?f:String(f).split("/")[2],count:y,special:c,type:t})});C.ok&&p("Story added successfully"),C.ok||p("Error while adding story")}catch{p("Error while adding story.")}}if(!o)return e.jsx("button",{className:"flex w-full cursor-pointer items-center justify-center rounded-lg border-2 border-white/20 bg-white/10 p-8 shadow-xl shadow-black/10 transition-all duration-200 hover:brightness-150",onClick:()=>d(!0),children:e.jsx(F,{size:30})});if(o)return e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsxs("form",{onSubmit:m,className:"flex flex-col gap-2 rounded-lg border-2 border-white/20 bg-white/10 p-2 **:disabled:opacity-35 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/20 [&_input]:bg-white/20 [&_input]:p-1 [&_input]:focus:outline-0",children:[e.jsx("label",{dir:"ltr",htmlFor:"title",children:"Title:"}),e.jsx("input",{value:n,onChange:i=>x(i.target.value)}),e.jsx("label",{dir:"ltr",htmlFor:"summary",children:"Summary:"}),e.jsx("input",{value:h,onChange:i=>b(i.target.value)}),e.jsx("label",{dir:"ltr",htmlFor:"newYear",children:"Year:"}),e.jsx("input",{dir:"ltr",value:f,onChange:i=>g(i.target.value)}),e.jsx("label",{dir:"ltr",children:"Count:"}),e.jsx("input",{dir:"ltr",value:y,onChange:i=>S(Number(i.target.value))}),e.jsxs("div",{className:`flex w-fit items-center justify-center gap-2 rounded p-1 ${c===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{id:"special",type:"checkbox",className:"opacity-30",checked:c,onChange:i=>w(i.target.checked)})]}),e.jsx("p",{children:s}),e.jsx("button",{type:"submit",className:"cursor-pointer bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"Add"})]}),e.jsx("button",{className:"flex w-full cursor-pointer items-center justify-center rounded-lg border-2 border-white/20 bg-white/10 p-8 shadow-xl shadow-black/10 transition-all duration-200 hover:brightness-150",onClick:()=>d(!1),children:e.jsx(k,{size:30})})]})}function B({type:t,stories:l,onDeleteStory:u,currentYear:o,setCurrentYear:d}){const[s,p]=r.useState(!1),n=r.useRef(null),x=()=>{n.current?.scrollTo({top:0,behavior:"smooth"})},{isAdmin:h}=j();return e.jsxs("div",{className:"relative w-full md:w-fit",children:[e.jsx("button",{className:"fixed top-4 left-4 z-100 rounded-xl border-2 border-white/20 bg-white/10 p-3 backdrop-blur-3xl",onClick:()=>p(!s),children:s?e.jsx(k,{size:25}):e.jsx(E,{size:25,strokeWidth:1})}),e.jsxs("div",{ref:n,className:`stories fixed top-20 z-50 flex h-[70%] w-full min-w-[300px] transform flex-col items-center gap-6 overflow-y-scroll border-t-2 border-b-2 border-white/20 bg-white/10 p-2 py-10 shadow-xl shadow-black/10 backdrop-blur-2xl transition-all duration-300 ease-out ${s?"pointer-events-auto translate-x-0 opacity-100":"pointer-events-none -translate-x-full opacity-0"} md:py-0 md:pt-25 md:pb-5 lg:left-5 lg:max-h-[80%] lg:w-fit lg:overflow-y-auto lg:rounded-xl lg:border-2 lg:py-5`,children:[h()&&l&&l[0]?.type!=="stats"&&e.jsx(P,{type:t,year:t!=="sepecial"?l!==null&&l[0]?.year?l[0]?.year:"":o,count:l.length>0?l[l.length-1].count+1:1}),l?e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"rounded-lg border-2 border-white/20 bg-white/10 p-2 px-5 font-bold shadow-xl shadow-black/10 focus:outline-0 [&_option]:bg-white/10 [&_option]:text-black",value:o,onChange:b=>d(b.target.value),children:[e.jsx("option",{value:"2026",children:"2026"}),e.jsx("option",{value:"2025",children:"2025"})]}),l.map((b,c)=>e.jsx(D,{onToggleEditPopup:x,story:b,currentYear:o,onDeleteStory:u,handleLinkClick:()=>{window.scrollTo({top:0,behavior:"smooth"})}},c))]}):null]})]})}const M=async(t,l)=>{const u=new Date().toLocaleTimeString(),o=new Date().toLocaleDateString(),d=navigator.platform+"";await fetch(`${v}/log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitedAt:`${u} - ${o}`,os:d,url:l,username:t})})};export{B as S,M as l};
