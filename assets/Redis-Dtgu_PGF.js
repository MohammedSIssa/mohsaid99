import{r,g as $,u as K,j as e,A as C,D as L}from"./index-FurLcunF.js";import{S as B}from"./auth-success-agsQj6pr.js";const D=({onClick:o})=>e.jsx("button",{onClick:o,className:"p-1 rounded-full hover:bg-red-200 transition",children:e.jsx("img",{src:L,width:20,height:20,alt:"Delete"})});function F(){const[o,j]=r.useState([]),[l,m]=r.useState(null),[w,x]=r.useState(null),[f,a]=r.useState(!1),[b,n]=r.useState(null),[g,y]=r.useState(""),c=new Audio(B),i=new Audio($),N=()=>{i.currentTime=0,i.volume=.5,i.play()},v=()=>{c.currentTime=0,c.volume=.35,c.play()},d=`${C}/redis`,{token:u,isAdmin:S}=K(),h=async()=>{try{a(!0);const s=await fetch(d,{headers:{authorization:`Bearer ${u}`}});if(!s.ok)throw new Error("Failed to fetch keys");v();const t=await s.json();j(Array.isArray(t)?t.flat():[])}catch(s){n(s.message)}finally{a(!1)}},A=async s=>{try{a(!0),m(s);const t=await fetch(`${d}/${s}`,{headers:{authorization:`Bearer ${u}`}});if(!t.ok)throw new Error("Failed to fetch key value");const k=await t.json();N(),x(k)}catch(t){n(t.message)}finally{a(!1)}},E=async s=>{try{if(a(!0),!(await fetch(`${d}/${s}`,{method:"DELETE",headers:{authorization:`Bearer ${u}`}})).ok)throw new Error("Failed to delete key");await h(),l===s&&(m(null),x(null))}catch(t){n(t.message)}finally{a(!1)}};r.useEffect(()=>{h()},[]);const p=o.filter(s=>s.toLowerCase().includes(g.toLowerCase()));return e.jsxs("div",{className:"p-6 font-sans mx-10 redis",dir:"ltr",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Redis Admin Panel"}),e.jsxs("div",{className:"flex gap-6 md:flex-row flex-col",children:[e.jsxs("div",{className:"md:w-1/3 bg-(--darker-bg-color) shadow rounded p-4 max-h-[500px] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Keys"}),e.jsx("button",{onClick:h,className:"px-2 py-1 bg-(--bg-color) border-2 cursor-pointer border-(--border-color) rounded transition",children:"Refresh"})]}),e.jsx("input",{type:"text",placeholder:"Search keys...",value:g,onChange:s=>y(s.target.value),className:"w-full mb-3 p-2 border rounded bg-(--bg-color) border-(--border-color)"}),f&&e.jsx("p",{className:"text-gray-500",children:"Loading..."}),b&&e.jsx("p",{className:"text-red-500",children:b}),!f&&p.length===0&&e.jsx("p",{className:"text-gray-400",children:"No keys found."}),e.jsx("ul",{className:"flex flex-col gap-2",children:p.map(s=>e.jsxs("li",{className:`flex justify-between items-center p-2 rounded cursor-pointer transition
        ${l===s?"bg-blue-700":""}`,children:[e.jsx("span",{className:"truncate max-w-[180px]",onClick:()=>A(s),title:s,children:s}),S&&e.jsx(D,{onClick:()=>E(s)})]},s))})]}),e.jsxs("div",{dir:"ltr",className:"md:w-2/3 bg-(--darker-bg-color) border-2 border-(--border-color) shadow rounded p-4 max-h-[500px] overflow-auto",children:[e.jsx("h3",{dir:"ltr",className:"text-lg font-semibold mb-2",children:"Value"}),l?e.jsxs(e.Fragment,{children:[e.jsxs("p",{dir:"ltr",className:"mb-2",children:[e.jsx("strong",{children:"Key:"})," ",l]}),e.jsx("pre",{dir:"ltr",className:"bg-(--bg-color) p-3 rounded overflow-auto",children:JSON.stringify(w,null,2)})]}):e.jsx("p",{className:"text-gray-400",children:"Select a key to view its value."})]})]})]})}export{F as default};
