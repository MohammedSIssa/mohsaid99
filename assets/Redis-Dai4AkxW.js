import{r,g as E,u as $,a as k,j as e,A as K,D as B}from"./index-DB7Oqjnw.js";import{S as D}from"./auth-success-agsQj6pr.js";const R=({onClick:l})=>e.jsx("button",{onClick:l,className:"p-1 rounded-full hover:bg-red-200 transition",children:e.jsx("img",{src:B,width:20,height:20,alt:"Delete"})});function F(){const[l,y]=r.useState([]),[o,m]=r.useState(null),[g,x]=r.useState(null),[f,a]=r.useState(!1),[p,n]=r.useState(null),c=new Audio(D),i=new Audio(E),j=()=>{i.currentTime=0,i.volume=.5,i.play()},b=()=>{c.currentTime=0,c.volume=.35,c.play()},d=`${K}/redis`,{token:u,isAdmin:w}=$(),{setType:N}=k();r.useEffect(()=>{N("redis")},[]);const h=async()=>{try{a(!0);const s=await fetch(d,{headers:{authorization:`Bearer ${u}`}});if(!s.ok)throw new Error("Failed to fetch keys");b();const t=await s.json();y(Array.isArray(t)?t.flat():[])}catch(s){n(s.message)}finally{a(!1)}},A=async s=>{try{a(!0),m(s);const t=await fetch(`${d}/${s}`,{headers:{authorization:`Bearer ${u}`}});if(!t.ok)throw new Error("Failed to fetch key value");const S=await t.json();j(),x(S)}catch(t){n(t.message)}finally{a(!1)}},v=async s=>{try{if(a(!0),!(await fetch(`${d}/${s}`,{method:"DELETE",headers:{authorization:`Bearer ${u}`}})).ok)throw new Error("Failed to delete key");await h(),o===s&&(m(null),x(null))}catch(t){n(t.message)}finally{a(!1)}};return r.useEffect(()=>{h()},[]),e.jsxs("div",{className:"p-6 font-sans mx-10 redis",dir:"ltr",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Redis Admin Panel"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"w-1/3 bg-(--darker-bg-color) shadow rounded p-4 max-h-[500px] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Keys"}),e.jsx("button",{onClick:h,className:"px-2 py-1 bg-(--bg-color) border-2 cursor-pointer border-(--border-color) rounded transition",children:"Refresh"})]}),f&&e.jsx("p",{className:"text-gray-500",children:"Loading..."}),p&&e.jsx("p",{className:"text-red-500",children:p}),l.length===0&&!f&&e.jsx("p",{className:"text-gray-400",children:"No keys found."}),Array.isArray(l)&&e.jsx("ul",{className:"flex flex-col gap-2",children:l.flat().map(s=>e.jsxs("li",{className:`flex justify-between items-center p-2 rounded cursor-pointer transition
        ${o===s?"bg-blue-700":""}`,children:[e.jsx("span",{className:"truncate max-w-[180px]",onClick:()=>A(s),title:s,children:s}),w&&e.jsx(R,{onClick:()=>v(s)})]},s))})]}),e.jsxs("div",{dir:"ltr",className:"w-2/3 bg-(--darker-bg-color) border-2 border-(--border-color) shadow rounded p-4 max-h-[500px] overflow-auto",children:[e.jsx("h3",{dir:"ltr",className:"text-lg font-semibold mb-2",children:"Value"}),o?e.jsxs(e.Fragment,{children:[e.jsxs("p",{dir:"ltr",className:"mb-2",children:[e.jsx("strong",{children:"Key:"})," ",o]}),e.jsx("pre",{dir:"ltr",className:"bg-(--bg-color) p-3 rounded overflow-auto",children:JSON.stringify(g,null,2)})]}):e.jsx("p",{className:"text-gray-400",children:"Select a key to view its value."})]})]})]})}export{F as default};
