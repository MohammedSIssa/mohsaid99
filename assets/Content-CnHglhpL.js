import{r,j as e,G as L,u as $,A as C,a as I,T as B,b as z,N as D,c as M}from"./index-CZE0Ms7r.js";import{S as T,l as G}from"./logger-DXSdVr8w.js";function R({body:t,showAllText:s=!1}){const[a,n]=r.useState(t?.length<60);function o(x){return/[\u0600-\u06FF]/.test(x)?"rtl":"ltr"}const l=o(t);return e.jsxs(e.Fragment,{children:[(a||s)&&e.jsx("div",{className:"flex flex-col gap-2 py-2",children:e.jsx("pre",{dir:l,className:"max-w-full md:max-w-[700px]",children:t})}),a||e.jsx("div",{className:"py-2",children:!s&&e.jsxs("pre",{dir:l,className:"max-w-full md:max-w-[700px]",children:[t?.slice(0,60),"..."," ",e.jsx("button",{className:"text-violet-300 hover:cursor-pointer hover:text-violet-200",onClick:()=>n(!0),children:"عرض المزيد"})]})})]})}function U(t){const s=t.endsWith("Z")?t:t+"Z",a=new Date(s),o=Math.floor((new Date().getTime()-a.getTime())/1e3);if(o<60)return`${o}s ago`;const l=Math.floor(o/60);if(l<60)return`${l}m ago`;const x=Math.floor(l/60);return x<24?`${x}h ago`:a.toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function Z({time:t}){return e.jsx("p",{className:"text-white/50",children:U(t)})}function W({title:t}){return e.jsx("h1",{className:"mb-3 text-3xl font-bold md:mb-5 md:text-4xl",children:t})}function Y({src:t,alt:s="",className:a=""}){const n=r.useRef(null),[o,l]=r.useState(!1);return r.useEffect(()=>{const x=n.current;if(!x)return;const h=new IntersectionObserver(([f])=>{f.isIntersecting&&(x.src=t,h.disconnect())},{rootMargin:"100px"});return h.observe(x),()=>h.disconnect()},[t]),e.jsx("img",{ref:n,alt:s,onLoad:()=>l(!0),className:`${a} max-h-full rounded-xl object-contain transition-opacity duration-300 ${o?"opacity-100":"opacity-0"}`})}function O({type:t,videoId:s}){const a=`https://www.youtube.com/embed/${s}?autoplay=1&controls=0&loop=1&playlist=${s}&mute=1`;return e.jsx("iframe",{className:t+" rounded-2xl",src:a,title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0})}function V({images:t}){const s=t[0].startsWith("video:"),a=s?t[0].split(":")[2]:null,n=s?t[0].split(":")[1]:null;return e.jsxs("div",{className:"slider flex max-h-full min-h-[200px] w-full max-w-full items-start justify-start gap-2 overflow-x-auto overflow-y-hidden rounded-2xl border-2 border-white/10 bg-white/10 p-4",children:[!s&&t.map((o,l)=>e.jsx(Y,{src:o},l)),s&&e.jsx(O,{type:n,videoId:a})]})}function H({goal:t}){const s=t.startsWith("✅");return e.jsx("h1",{className:`${s?"border-green-100/40 bg-green-500/40 text-green-100":"border-white/10 bg-white/10"} rounded-lg border-2 p-2 px-3`,children:t})}function J({goals:t}){return e.jsx("div",{className:"flex flex-col gap-2",children:t.map((s,a)=>e.jsx(H,{goal:s},a))})}function q(t){return L({attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z",clipRule:"evenodd"},child:[]}]})(t)}function K({post:t}){const[s,a]=r.useState(t.title??""),[n,o]=r.useState(t.body??""),[l,x]=r.useState(t?.images?.join(", ")??""),[h,f]=r.useState(t.images??[]),[N,g]=r.useState(t.special??!1),[w,v]=r.useState(t.secret??!1),[S,_]=r.useState(t.type??""),[c,m]=r.useState(t.storyid??0),[u,b]=r.useState(!1),[k,y]=r.useState(""),{user:p}=$();async function d(i){i.preventDefault();try{y("Updating..."),b(!0);const j=await fetch(`${C}/posts?fromtype=${t.type}&fromcount=${t.storyid}&id=${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json",authorization:`Bearer: ${p?.apikey}`},body:JSON.stringify({title:s,body:n,images:h,special:N,secret:w,type:S,storyid:c})});j.ok&&(b(!1),y("Updated!")),j.status===500&&y("Server Error!"),j.status>=400&&j.status<500&&y("Unauthorized!")}catch(j){console.error(j),y("Client Error!"),b(!1)}}return e.jsxs("form",{onSubmit:d,className:"flex flex-col gap-1 rounded-xl border-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl **:disabled:opacity-35 [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-white/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-white/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{disabled:u,id:"title",value:s,onChange:i=>a(i.target.value)}),e.jsxs("label",{htmlFor:"storyid",dir:"ltr",children:["Story Count:"," "]}),e.jsx("input",{disabled:u,id:"storyid",type:"number",value:c,onChange:i=>m(+i.target.value)}),e.jsxs("label",{htmlFor:"type",dir:"ltr",children:["Type:"," "]}),e.jsxs("select",{disabled:u,className:"[&_option]:bg-black",value:S,onChange:i=>_(i.target.value),children:[e.jsx("option",{value:"week",children:"Weeks"}),e.jsx("option",{value:"goal",children:"Goals"}),e.jsx("option",{value:"blog",children:"Blogs"}),e.jsx("option",{value:"special",children:"Special"})]}),e.jsxs("label",{htmlFor:"body",dir:"ltr",children:["Body:"," "]}),e.jsx("textarea",{disabled:u,id:"body",value:n,onChange:i=>o(i.target.value)}),e.jsxs("label",{htmlFor:"images",dir:"ltr",children:["Images:"," "]}),e.jsx("textarea",{disabled:u,id:"images",dir:"ltr",value:l,onChange:i=>{const j=i.target.value;x(j);const P=j.split(", ").map(A=>A.trim()).filter(Boolean);f(P)}}),e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-white/10 [&_div]:p-2",children:[e.jsxs("div",{className:`flex items-center justify-center gap-2 ${N===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{disabled:u,id:"special",type:"checkbox",className:"opacity-30",checked:N,onChange:i=>g(i.target.checked)})]}),e.jsxs("div",{className:`flex items-center justify-center gap-2 ${w===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"secret",dir:"ltr",children:"Secret?"}),e.jsx("input",{disabled:u,id:"secret",type:"checkbox",className:"opacity-30",checked:w,onChange:i=>v(i.target.checked)})]})]}),e.jsx("p",{dir:"ltr",children:k}),e.jsx("button",{disabled:u,type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"حفظ التعديلات"})]})}function E({post:t,isPerview:s=!1}){const[a,n]=r.useState(!1),{isAdmin:o,isMonmon:l,user:x}=$(),h=t.secret&&(o()||l());async function f(){try{window.confirm(`Are you sure you want to fetch(${"/posts/"+t.type+"/"+t.storyid+"/"+t.id})`)&&(await fetch(`${C}/posts?type=${t.type}&storyid=${t.storyid}&id=${t.id}`,{method:"DELETE",headers:{authorization:`Bearer: ${x?.apikey}`}})).ok&&alert("Deleted post!")}catch{alert("Could not delete post!")}}return e.jsxs("div",{className:`${h?"flex":t.secret?"hidden":"flex"} ${t.special?"special border-yellow-300/30 bg-yellow-300/20 text-yellow-200":""} ${t.secret?"secret text-fuchsia-300":""} post relative w-full max-w-full flex-col gap-2 border-t-2 border-b-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl md:w-fit md:max-w-[700px] md:min-w-[350px] md:rounded-xl md:border-2 lg:max-w-[900px]`,children:[!a&&e.jsxs(e.Fragment,{children:[e.jsx(W,{title:t?.title??""}),(t?.id??500)>436&&!s&&t?.type!=="goal"&&e.jsx(Z,{time:t.iat??""}),t.type!=="goal"&&e.jsx(R,{body:t?.body??"",showAllText:t?.images?.length===0}),t.type==="goal"&&e.jsx(J,{goals:t.body.split(`
`)}),t?.images&&t?.images.length>0&&e.jsx(V,{images:t?.images??[]})]}),a&&e.jsx(K,{post:t}),o()&&!s&&e.jsxs("div",{className:"absolute -top-15 left-2 flex gap-2 rounded-lg border-2 border-white/20 bg-black/20 p-2 px-3 shadow-xl shadow-black/10 [&_button]:cursor-pointer [&_button]:transition-all [&_button]:duration-200 [&_button]:hover:brightness-90",children:[e.jsx("button",{className:"place-items-center rounded-lg bg-blue-600 p-2 text-white backdrop-blur-2xl",onClick:()=>n(!a),children:a?e.jsx(I,{size:18}):e.jsx(B,{size:18})}),e.jsx("button",{className:"place-items-center rounded-lg bg-red-500 p-2 text-white backdrop-blur-2xl",onClick:f,children:e.jsx(q,{size:18})})]})]})}function Q({type:t,storyid:s}){const[a,n]=r.useState(""),[o,l]=r.useState(""),[x,h]=r.useState(""),[f,N]=r.useState([]),[g,w]=r.useState(!1),[v,S]=r.useState(!1),[_,c]=r.useState(!1),[m,u]=r.useState(""),[b,k]=r.useState(!1),{user:y}=$();async function p(d){d.preventDefault();try{k(!0),u("Adding post..");const i=await fetch(`${C}/posts?type=${t}&storyid=${s}`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer: ${y?.apikey}`},body:JSON.stringify({title:a,body:o,images:f,special:g,secret:v,type:t,storyid:s})});i.ok&&(u("Post added successfully!"),n(""),l(""),S(!1),w(!1),h("")),i.status===500&&u("Server Error!"),i.status>=400&&i.status<500&&u("Unauthorized!")}catch(i){console.error(i),u("Client Error!")}finally{k(!1)}}if(!_)return e.jsx("button",{className:"cursor-pointer rounded-xl border-2 border-white/20 bg-white/10 p-10 px-25 transition-all duration-200 hover:brightness-150",onClick:()=>c(!0),children:e.jsx(z,{size:30})});if(_)return e.jsxs("div",{className:"mb-5 flex flex-col items-center gap-5",children:[e.jsxs("form",{onSubmit:p,className:"flex max-w-fit flex-col gap-1 rounded-xl border-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl **:disabled:opacity-35 md:min-w-[400px] [&_input]:mb-4 [&_input]:rounded [&_input]:border-2 [&_input]:border-white/10 [&_input]:bg-white/10 [&_input]:p-1 [&_input]:px-2 [&_input]:focus:outline-0 [&_select]:rounded [&_select]:border-2 [&_select]:border-white/10 [&_select]:bg-white/10 [&_select]:p-1 [&_select]:px-2 [&_select]:focus:outline-0 [&_textarea]:mb-4 [&_textarea]:rounded [&_textarea]:border-2 [&_textarea]:border-white/10 [&_textarea]:bg-white/10 [&_textarea]:p-1 [&_textarea]:px-2 [&_textarea]:focus:outline-0",dir:"ltr",children:[e.jsxs("h1",{className:"font-bold",dir:"ltr",children:["Add a post for ",t," ",s]}),e.jsxs("label",{htmlFor:"title",dir:"ltr",children:["Title:"," "]}),e.jsx("input",{disabled:b,id:"title",value:a,onChange:d=>n(d.target.value)}),e.jsxs("label",{htmlFor:"body",dir:"ltr",children:["Body:"," "]}),e.jsx("textarea",{disabled:b,id:"body",value:o,onChange:d=>l(d.target.value)}),e.jsxs("label",{htmlFor:"images",dir:"ltr",children:["Images:"," "]}),e.jsx("textarea",{disabled:b,id:"images",dir:"ltr",value:x,onChange:d=>{const i=d.target.value;h(i);const j=i.split(", ").map(P=>P.trim()).filter(Boolean);N(j)}}),e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2 [&_div]:rounded-xl [&_div]:border-2 [&_div]:border-white/10 [&_div]:p-2",children:[e.jsxs("div",{className:`flex items-center justify-center gap-2 ${g===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"special",dir:"ltr",children:"Special?"}),e.jsx("input",{disabled:b,id:"special",type:"checkbox",className:"opacity-30",checked:g,onChange:d=>w(d.target.checked)})]}),e.jsxs("div",{className:`flex items-center justify-center gap-2 ${v===!0?"bg-green-500/30":"bg-red-500/30"}`,children:[e.jsx("label",{htmlFor:"secret",dir:"ltr",children:"Secret?"}),e.jsx("input",{id:"secret",type:"checkbox",className:"opacity-30",checked:v,onChange:d=>S(d.target.checked)})]})]}),e.jsx("p",{dir:"ltr",children:m}),e.jsx("button",{type:"submit",className:"w-full cursor-pointer rounded-lg border-0 bg-linear-to-b from-[#5a36e9] via-[#805afe] to-[#5a36e9] p-1 px-2 font-bold hover:brightness-105 focus:outline-0",children:"اضافة المنشور"})]}),e.jsx(E,{post:{title:a,body:o,images:f,special:g,secret:v,type:t,storyid:s},isPerview:!0}),e.jsx("button",{className:"cursor-pointer rounded-xl border-2 border-white/20 bg-white/10 p-10 px-25 transition-all duration-200 hover:brightness-150",onClick:()=>c(!1),children:e.jsx(I,{size:30})})]})}const X={week:"الأسابيع",goal:"الأهداف",special:"خاص",stat:"احصائيات",blog:"المدونة"};function ee({posts:t,type:s,storyid:a}){const{isAdmin:n}=$();return e.jsxs("div",{className:"flex w-full flex-col items-center pt-20",children:[e.jsxs("div",{className:"mx-auto mb-2 flex gap-2 md:hidden",children:[e.jsx("p",{className:"rounded border-2 border-white/20 bg-white/10 p-2 px-5 font-bold",children:X[s]}),e.jsxs("p",{className:"counter rounded border-2 border-white/20 bg-white/10 p-2 px-5 font-bold",children:["#",a]})]}),e.jsx("div",{className:"mb-5",children:n()&&e.jsx(Q,{type:s,storyid:a})}),!n()&&t.length===0&&e.jsx("h1",{className:"text-2xl font-bold",children:"لا توجد منشورات"}),e.jsx("div",{className:"flex w-full flex-col items-center gap-17",children:t.map((o,l)=>e.jsx(E,{post:o},l))})]})}function te(){const{isAdmin:t}=$(),s=Array.from({length:5});return e.jsx("div",{className:`flex w-full flex-col items-center gap-5 overflow-y-hidden ${t()?"pt-66 md:pt-53":"pt-38 md:pt-25"}`,children:s.map((a,n)=>e.jsxs("div",{className:"flex w-full max-w-full animate-pulse flex-col gap-2 border-t-2 border-b-2 border-white/20 bg-white/10 p-3 py-5 shadow-xl shadow-black/10 backdrop-blur-2xl odd:min-h-[200px] even:min-h-[350px] even:delay-200 md:w-fit md:max-w-[700px] md:rounded-xl md:border-2 md:odd:min-w-[600px] md:even:min-w-[700px] [&_div]:rounded-lg",children:[e.jsx("div",{className:"mb-5 w-[40%] animate-pulse bg-white/10 p-5"}),e.jsx("div",{className:"w-[70%] animate-pulse bg-white/10 p-2"}),e.jsx("div",{className:"w-[50%] animate-pulse bg-white/10 p-2"}),e.jsx("div",{className:"w-[60%] animate-pulse bg-white/10 p-2"}),e.jsx("div",{className:"h-[200px] max-h-[60%] w-full animate-pulse bg-white/10 p-2"})]},n))})}function se(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة الأهداف"}),e.jsx("p",{children:"هنا بكتب أهداف كل ربع بالسنة"}),e.jsx("p",{children:"الهدف هنا التركيز على أهدافي ومحاولة تحقيقها"})]})}function re(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة الأسابيع أو اليوميات"}),e.jsx("p",{children:"هنا بكتب آخر الأحداث اللي بتصير معي"}),e.jsx("p",{children:"الرحلة موثقة هنا من أول يوم بسنة 2025"})]})}function ae(){return e.jsxs("div",{className:"pt-20 text-center text-pretty",children:[e.jsx("h1",{className:"mb-8 text-2xl font-bold md:text-3xl lg:text-4xl [&_p]:mb-3",children:"صفحة المحتوى الخاص"}),e.jsx("p",{children:"الجزء هاد كان هدية الـ11 شهر"}),e.jsx("p",{children:" المحتوى هنا محدش بيقدر يشوفو غير شخص واحد"}),e.jsx("p",{children:"هان بكتب آخر التطورات بشكل شخصي اكتر"})]})}function ie({type:t}){return e.jsxs("div",{className:"bg-stars",children:[t==="week"&&e.jsx(re,{}),t==="goal"&&e.jsx(se,{}),t==="special"&&e.jsx(ae,{})]})}function F(){return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-5 p-10",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"هاد الصفحة غير موجودة"}),e.jsx(D,{to:"/",className:"text-violet-200 underline",replace:!0,children:"اضغط هنا"})]})}function oe({toType:t=null}){const[s,a]=r.useState(null),[n,o]=r.useState(null),[l,x]=r.useState(2026),[h,f]=r.useState(!0),[N,g]=r.useState(!1),[w,v]=r.useState(!0),[S,_]=r.useState(!1),{type:c,storyid:m}=M(),{isAdmin:u}=$(),{user:b}=$(),k=["week","blog","goal","special"];function y(p){a(d=>d?.filter(i=>i.count!==p)??null)}return r.useEffect(()=>{async function p(){try{f(!0);const d=await fetch(`${C}/stories?type=${t||c}&year=${l}`);if(d.ok){const i=await d.json();a(i),g(!1)}else g(!0)}catch{g(!0)}finally{f(!1)}}t&&["week","blog","goal","special"].includes(t)&&p(),!t&&c&&["week","blog","goal","special"].includes(c)&&p()},[c,t,l]),r.useEffect(()=>{async function p(){try{v(!0);const d=await fetch(`${C}/posts?type=${t||c}&storyid=${m}`);if(d.ok){const i=await d.json();o(i),_(!1),u()||await G(b?.username??"guest",`${t||c} - ${m}`)}}catch{_(!0)}finally{v(!1)}}m!==void 0&&p()},[c,m,u,b?.username,t,b,l]),t&&!k.includes(t)?e.jsx(F,{}):!t&&c&&!k.includes(c)?e.jsx(F,{}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 md:flex-row",children:[N&&e.jsx("h1",{}),h&&e.jsx("div",{className:"flex items-center justify-center p-40",children:e.jsx("span",{className:"h-20 w-20 animate-spin rounded-xl border-2 border-white/20 bg-white/20"})}),!h&&e.jsx(T,{type:t||(c??""),stories:s??[],onDeleteStory:y,currentYear:l,setCurrentYear:p=>x(parseInt(p))}),w&&m!==void 0&&e.jsx(te,{}),!h&&m===void 0&&e.jsx(ie,{type:s?.[0]?.type}),S&&e.jsx("h1",{}),!w&&m!==void 0&&e.jsx(ee,{posts:n??[],type:!t&&c!==void 0?c:t||"",storyid:m!==void 0?parseInt(m):0})]})})}export{oe as default};
