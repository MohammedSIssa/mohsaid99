import{r as s,u as v,e as w,j as e,S as h,A as y,s as N}from"./index-DeMiJ4k5.js";const S="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='%232d6'%20fill-rule='evenodd'%20d='M12%2021a9%209%200%201%200%200-18a9%209%200%200%200%200%2018m-.232-5.36l5-6l-1.536-1.28l-4.3%205.159l-2.225-2.226l-1.414%201.414l3%203l.774.774z'%20clip-rule='evenodd'/%3e%3c/svg%3e";function T(){const[l,u]=s.useState(""),[i,x]=s.useState(""),[f,r]=s.useState(!1),{setUser:g,loading:m,isAuthenticated:o,setToken:c}=v(),d=w(),[p,b]=s.useState(!1);if(s.useEffect(()=>{o&&(b(!0),setTimeout(()=>{d("/")},2e3))},[o,d]),p)return e.jsxs("div",{className:"flex h-dvh items-center flex-col gap-5 justify-center",children:[e.jsx("h1",{className:"text-2xl text-green-400 font-bold",children:"تم تسجيل الدخول بنجاح"}),e.jsx("img",{src:S,width:120,height:120}),e.jsx("h1",{className:"font-bold text-lg capitalize text-violet-300",children:l}),e.jsx("p",{children:"جاري إعادة التوجيه إلى الصفحة الرئيسية..."})]});if(m)return e.jsxs("div",{className:"h-dvh flex flex-col items-center gap-5 justify-center",children:[e.jsx("h1",{children:"جار توثيق المستخدم.."}),e.jsx("div",{className:"h-7 w-7 animate-spin",children:e.jsx("img",{src:h,width:28,height:28})})]});if(f)return e.jsxs("div",{className:"h-dvh flex flex-col items-center gap-5 justify-center",children:[e.jsx("h1",{children:"جار تسجيل الدخول للمستخدم.."}),e.jsx("div",{className:"h-7 w-7 animate-spin",children:e.jsx("img",{src:h,width:28,height:28})})]});async function j(t){t.preventDefault();try{r(!0);const n=await fetch(`${y}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,password:i})});if(n.ok){r(!1);const a=await n.json();console.log(a),N(a.token),c&&c(a.token),g(a.user)}else alert("Login failed"),r(!1)}catch{alert("Network error"),r(!1)}}if(!o)return e.jsx("div",{className:"h-dvh flex items-center justify-center",children:e.jsxs("form",{dir:"ltr",className:"bg-(--darker-bg-color) py-16 max-w-full rounded-lg border-2 border-(--border-color) flex flex-col gap-4 px-7",onSubmit:j,children:[e.jsx("h1",{className:"text-2xl font-bold text-center mb-4",children:"تسجيل الدخول"}),e.jsx("input",{className:"bg-(--bg-color) year border border-(--border-color) p-2 px-3 rounded focus:outline-0",dir:"ltr",type:"text",placeholder:"Username",value:l,onChange:t=>u(t.target.value)}),e.jsx("input",{className:"bg-(--bg-color) year border border-(--border-color) p-2 px-3 rounded focus:outline-0",dir:"ltr",type:"password",placeholder:"Password",value:i,onChange:t=>x(t.target.value)}),e.jsx("button",{className:"bg-(--accent-color) p-2 px-3 rounded text-(--bg-color) year font-bold hover:brightness-110 transition-all duration-200 cursor-pointer",type:"submit",children:"Login"})]})})}export{T as default};
